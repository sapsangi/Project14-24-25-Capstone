PDF Content from https://transition.fcc.gov/pshs/advisory/csric4/CSRIC_IV_WG5_Remediation_of_Server-Based_DDoS_Attacks_Report_Final_(pdf)_V11.pdf:
September, 2014
WORKING GROUP 5
Remediation of Server Based DDoS Attacks
Final Report
‐The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
Table of Contents
1 Results in Brief ......................................................................................................................... 3
1.1 Executive Summary ......................................................................................................... 3
2 Introduction .............................................................................................................................. 3
2.1 CSRIC IV Structure ......................................................................................................... 9
2.2 Working Group 5 Team Members ................................................................................... 9
3 Objective, Scope, and Methodology ...................................................................................... 10
3.1 Objective ........................................................................................................................ 10
3.2 Scope .............................................................................................................................. 10
3.3 Methodology ........................................................................................................................ 11
3.3 Metrics ............................................................................................................................ 12
3.4 Barriers to Participation ................................................................................................. 13
3.4.1 Barriers to Participation: Considerations ............................................................... 13
3.4.1.1 Technology Barriers ............................................................................................ 13
3.4.1.2 Customer/Market Barriers ................................................................................... 14
3.4.1.3 Operational Barriers ............................................................................................ 14
3.4.1.4 Financial Barriers ................................................................................................ 14
3.4.1.5 Legal/Policy Barriers........................................................................................... 14
3.4.1.6 Barriers - Server Based DDoS Attacks ............................................................... 15
4 Background ............................................................................................................................ 16
5 Analysis, Findings, and Conclusions ..................................................................................... 17
5.1 Analysis .......................................................................................................................... 17
5.2 Findings .......................................................................................................................... 19
5.3 Conclusions ......................................................................................................................... 20
6 Recommendations .................................................................................................................. 20
7 Acknowledgements ................................................................................................................ 21
8 Appendices ............................................................................................................................. 21
Page 2The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
1 Results in Brief
1.1 Executive Summary
Critical infrastructure sectors have been under assault from a barrage of DDoS attacks, some of
which have emanated from data centers and Hosting Providers.1 DDoS attacks originating from
data centers and Hosting Providers are especially problematic because of the high bandwidth
and computational resources available to an attacker. This makes prevention, detection, and
mitigation more important, yet more difficult. This Working Group examined and has made
recommendations to the Council regarding network level best practices and other measures that
communications providers and the FCC can take to mitigate the effects of DDoS attacks from
large data centers and hosting sites. These recommendations include technical/operational
methods and procedures to facilitate stakeholder implementation of the recommendations. While
this report is focused on communications providers, it should be noted that it will require actions
taken across the internet ecosystem, including actions by Hosting Providers, equipment
suppliers, owners and operators of critical infrastructure, other stakeholders who rely on the
internet, and even potentially end users themselves to successfully mitigate DDoS attacks.
Working Group 5 also recognizes that, while largely outside of the scope of this report, server-
based DDoS attacks are not only a national problem; it is a global problem. Ultimately, the
actions taken by the internet ecosystem include international considerations.
In this final report, Working Group 5 has provided recommendations that communications
providers can take to mitigate the incidence and impact of DDoS attacks from data centers and
Hosting Providers, particularly those targeting the information systems of critical infrastructure
sectors.2 The recommendations are mainly in the form of server-based DDoS mitigation Best
Practices (BPs) found in Appendix E. In addition, several actionable recommendations are
included here to further the work to prevent, detect, and mitigate server-based DDoS attacks.
Working Group 5 also assessed the ISPs’ level of effort in implementing the BPs compared with
the impact of implementing specific best practices to determine the subset of best practices that
have a high impact but relatively low level of effort to implement. The working group also
focused on identifying barriers to implementation of the BPs based upon the lessons learned
from the ISP, Internet Security Experts, and Financial Community subgroups’ case studies as
well as other barriers based on the members’ actual experiences with mitigating DDoS attacks.
The Working Group also developed a taxonomy for use in applying the best practices. Finally,
the group addressed potential effectiveness measures aimed at measuring successful outcomes of
the voluntary network level BPs to mitigate server-based DDoS attacks.
2 Introduction
This final report documents the efforts undertaken by CSRIC IV Working Group 5 and provides
best practices communications providers can follow to mitigate server-based DDoS attacks
launched from servers typically based in data centers and Hosting Providers. The final report
also provides recommendations regarding actions the FCC can take to assist in mitigating the
1 http://www.eweek.com/security/ddos-attacks-on-major-banks-causing-problems-for-
customers/
2 http://www.dhs.gov/critical-infrastructure-sectors
Page 3The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
occurrence and impact of server-based DDoS attacks.
Working Group 5 has assembled a team of 40+ members, including representatives from ISPs,
financial institutions, Hosting Providers, non-profits, associations, academia, federal and state
governments, and security experts to accomplish the CSRIC IV charge. CSRIC IV Working
Group 5 efforts leveraged and complement other botnet activities, including:
• CSRIC II3 and CSRIC III4 DDoS Mitigation Recommendations
• Messaging, Malware, Mobile Anti-Abuse Working Group (M3AAWG)5
• Online Trust Alliance (OTA) Anti-Botnet Working Group6
• Cloud Security Alliance (CSA) 7
• Industry Botnet Group (IBG)8
Working Group 5 considered the basic structure of a typical DDoS attack, and the differing
types of DDoS attacks seen in the current network environments. Figure 1 shows an illustrative
server-based DDoS attack. Recent DDoS attacks have exploited vulnerabilities in web-hosting
companies and other large data centers to launch DDoS attacks on computer systems and
websites. These attacks can originate domestically or internationally with domestic or
international targets. Prevention, detection, and mitigation of these attacks is complex requiring
cooperation and information sharing among ISPs and Network Operators, data centers and
Hosting Providers, infrastructure manufacturers (i.e., the supply chain), and critical
infrastructure owners and operators. The Working Group used the ecosystem interaction
described above as a basis for deciding which case studies would be undertaken and which
attendant industry best practices would be considered for this mitigation task addressing server-
based DDoS attacks.
3 http://www.fcc.gov/encyclopedia/communications-security-reliability-and-interoperability-
council-ii
4 http://www.fcc.gov/encyclopedia/communications-security-reliability-and-interoperability-
council-iii
5 http://www.maawg.org/m3aawg-san-francisco-meeting-addresses-latest-messaging-security-
ranging-mobile-malware-ddos-attacks
6 https://otalliance.org/resources/botnets
7 https://cloudsecurityalliance.org/
8 http://www.ustelecom.org/blog/industry-botnet-group-takes-multi-party-approach-fight-
cybercrime
Page 4The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
Working Group 5 also performed a gap analysis to determine where best practices were missing,
but required, in order to align with the phases of an ISP’s incident response life-cycle in
protecting and responding to server-based DDoS attacks. Where gaps were identified, the
Working Group made recommendations for new best practices.
Working Group 5 applied the incident response life cycle as a way to map DDoS best practices
and recommendations. This mapping, along with prioritized recommendations in each area, will
help ISPs identify the most important and effective best practices and recommendations in each
area. The Working Group has adapted Arbor Network’s “Incident Life-Cycle” to “The Six
Phases of DDoS Attack Preparation and Response” for the purposes of this final report, see
Figure 2 below.
Page 5The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
Figure 2. Six Phases of DDoS Attack Preparation and Response.
In conjunction with the Six Phases model, a taxonomy of activities (Appendix A) was created in
order to provide guidance on how best practices could be used in each phase. The Six Phases
model is an attack preparation and response method consistent with the NIST Cybersecurity
Framework.9 The Six Phases operational model relates to the NIST Cybersecurity Framework
as follows: The Preparation Phase implements the NIST Identify Function to identify network
assets to be protected and provides the NIST Protection Function by preparing the network and
creating DDoS detection and mitigation tools. The Identification, Classification, and Traceback
phases relate to the NIST Detect Function. The Reaction Phase relates to the NIST Respond
Function, and the Post Mortem Phase to the NIST Recover Function. This relationship is shown
below in Figure 3.
9 http://www.nist.gov/cyberframework/upload/cybersecurity-framework-021214.pdf
Page 6The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
Figure 3. Relationship of Six Phase Operational Process to NIST Cybersecurity
Framework.
For the purposes of the analysis, the Working Group used the following definition of a DDoS
Attack: “a Denial-of-Service (DoS) or Distributed Denial-of-Service (DDoS) attack is an
attempt to prevent legitimate users from accessing information or services10 (US-CERT).” A
distributed denial of service attack consists of two or more systems or attackers engaged in the
attack at the same time to the same target. The following are types of DDoS attacks:
• Volumetric Attacks
Direct Packet Flooding
o
 Compromised, remote control computers (bots) send attack traffic directly to
the victim trying to fill the circuits with bad traffic.
 Hundreds to tens of thousands of bots can participate.
 Standard ISP tools handle most of these types of attacks fairly well.
 Packets can be either spoofed or not spoofed.
Reflective Amplification Attacks
o
 Bots spoof their source IP address to be the IP address of the victim.
 Send traffic to services where the response will be much greater than the
question.
10 http://www.us-cert.gov/ncas/tips/ST04-015
Page 7The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
 DNS servers are great amplifiers for these types of attacks.
 Amplification factors of 200+ times are possible.
 Packets must be spoofed.
• Application Layer Attacks
Malicious software on bots is tailored to send traffic to the webserver or other
o
application server that appears to be from a legitimate customer and consumer’s
significant computer resources.
Lower traffic volumes.
o
More work required of the attackers to achieve their goals.
o
Encrypted traffic more difficult to mitigate.
o
Full mitigation needs to look at unencrypted packets. Some mitigation can occur
o
with encrypted packets only
Packets generally cannot be spoofed.
o
Domain Name Service (DNS) Attacks
o
 DNS is one of two critical services on the Internet, without which almost all
Internet applications fail (mail, web, etc). DNS is the white pages for the
Internet.
 Instead of attacking the victim directly, the attackers will attack the victim’s
ISP DNS services, taking down the victim’s traffic.
 The attack not only affects the victim’s traffic, but can affect many other ISP
customers even though they may not be the target of the attack.
• State Exhaustion Attacks
Devices that keep state on connections such as servers, firewalls, and intrusion
o
detection/prevention systems that have limited state capabilities.
• Control Plane Attacks
Routing protocols such as Border Gateway Protocol (BGP) and Open Shortest Path
o
First (OSPF).
The Working Group used the above attack types in identifying server-based DDoS attack
mitigation best practices as well as discussed general mitigation tools and techniques for those
attacks in forming a framework for the Working Group’s recommendations.
Page 8The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
2.1 CSRIC IV Structure
Communications Security, Reliability, and Interoperability Council (CSRIC) IV
CSRIC Steering Committee
Chair or Chair or Chair or Chair or Co- Chair or Chair or Co- Chair or Chair or Chair or Co- Chair or
Co-Chairs: Co-Chairs: Co- Chairs: Co- Chairs: Co- Co-Chairs: Chairs: Co-
Working Working Chairs: Working Chairs: Working Chairs: Working Working Chairs:
Group 1 Group 2 Working Group 4 Working Group 6 Working Group 8 Group 9 Working
Group 3 Group 5 Group 7 Group 10
Working Working Working Working Working Working Working Working Working Working
Group 1: Group 2: Group 3: Group 4: Group 5: Group 6: Group 7: Group 8: Group 9: Group
Next Wireless EAS Cybersecurity Server- Long-Term Legacy Submarine Infrastructure 10: CPE
Generation Emergency Best Practices Based Core Internet Best Cable Sharing Powering
911 Alerts DDoS Protocol Practice Landing During
Attacks Improvements Updates Sites Emergencies
Table 1 – CSRIC IV Working Group Structure.
2.2 Working Group 5 Team Members
Working Group 5 consists of the members listed below.
Name Company
Peter Fonash (Co-Chair) DHS
Michael Glenn (Co-Chair) CenturyLink
Paul Diamond (Co-Editor) CenturyLink
Robert Thornberry (Co-Editor) Bell Labs, Alcatel-Lucent
Vernon Mosley (FCC Liaison) FCC
Jared Allison Verizon
Don Blumenthal Public Interest Registry
Chris Boyer AT&T
Matt Carothers Cox Communications
Roy Cormier Nsight
Dave DeCoster Shadowserver
John Denning FSSCC
Roland Dobbins Arbor Networks
Martin Dolly ATIS
David Fernandez Prolexic Technologies
Mark Ghassemzadeh ACS
Darren Grabowski NTT
Sam Grosby Wells Fargo
Rodney Joffe Neustar
John Levine CAUCE
Gregory Lucak Windstream
John Marinho CTIA
Dan Massey IEEE
Ron Mathis Intrado
Bill McInnis Internet Identity
Chris Morrow Google
Michael O’Reirdan MAAWG
Eric Osterweil VeriSign, Inc.
Wayne Pacine Fed Reserve Board of Governors
Glen Pirrotta Comcast
Page 9The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
R.H. Powell Akamai
Nick Rascona Sprint
Chris Roosenraad Time Warner Cable
Craig Spiezle Online Trust Alliance
Joe St Sauver Univ of Oregon/Internet2
Kevin Sullivan Microsoft
Bernie Thomas CSG International
Matt Tooley NCTA
Errol Weiss FSSCC
Pam Witmer PA Public Utility Commission
Table 2 - List of Working Group 5 Members.
3 Objective, Scope, and Methodology
3.1 Objective
This Working Group was charged with examining and making recommendations to the Council
regarding network level best practices and other measures to mitigate the effects of DDoS
attacks from large data centers and hosting sites. The Working Group’s objective was to
organize a working group with a wide range of experience and expertise, and include both
government and industry participants. The Working Group 5 Objectives11 are:
WG5 Objectives
Description:
Critical infrastructure sectors, including the financial sector, have been under assault
from a barrage of DDoSattacks emanating from data centers and hosting providers.
This Working Group will examine and make recommendations to the Council regarding
network level best practices and other measures to mitigate the effects of DDoS
attacks from large data centers and hosting sites. These recommendations should
include technical and operational methods and procedures to facilitate stakeholder
implementation of the recommended solution(s).
Deliverable:
Recommended measures communications providers can take to mitigate the
incidence and impact of DDoSattacks from data centers and hosting providers,
particularly those targeting the information systems of critical sectors.
2
3.2 Scope
There has been a rapid increase in the volume, size, and scope of DDoS attacks for several years
which have created challenges for Internet Service Providers due to the increased volume seen in
11
http://transition.fcc.gov/bureaus/pshs/advisory/csric4/CSRIC_IV_Working_Group_Descriptions_5_7_14.pdf
Page 10The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
their networks. Recent attacks have relied on infected tenants within large data hosting
centers.12 In order to address the server-based DDoS attack problem, Working Group 5
employed a holistic approach (e.g., multiple stakeholders represented across the ecosystem) with
a focus on the actions that Network Operators could take to prevent and mitigate DDoS attacks.
The holistic approach was needed since the causes and impacts of DDoS attacks need to be
addressed by the entire network and hosting ecosystem in order to be effective. Addressing this
attack vector has become a priority across all the ecosystem stakeholders.
Working Group 5’s approach was to be as inclusive as possible without repeating or duplicating
efforts undertaken by other groups addressing other aspects of the server-based DDoS attack
problem. Also, Working Group 5’s approach was to focus on efforts which would result in
recommended actions specifically toward server-based DDoS attacks, i.e., many best practices
reviewed were recognized as being valuable, were good best practices in general, but not
specific to server-based DDoS attacks and so were not included within the scope of Working
Group 5’s tasking. One exception was for recommendations to protect against Domain Name
System (DNS) Denial of Service attacks. Repeated and recent DNS attacks have been especially
egregious, thus mitigation best practices were included in Working Group 5’s work.13
3.3 Methodology
Working Group 5 began by identifying subgroups to appropriately focus on case studies of
server-based DDoS attacks and industry best practices analysis. The following four subgroups
resulted from that focus: ISPs, Financial Community, Internet Security Experts, and Best
Practices subgroups.
The Best Practices subgroup identified applicable BPs for DDoS server-based attacks while the
ISPs, Financial Community, and Internet Security Experts subgroups developed representative
case studies for server-based DDoS attacks. The Working Group 5 at large then associated
network level best practices to each subgroup area as well as other measures to mitigate the
effects of DDoS attacks from large data centers and hosting sites.
Working Group 5 held biweekly conference calls with its working group members to
accomplish the tasking. Additionally, the subgroups held biweekly conference calls to solicit
input and review their case study deliverables. Working Group 5 held a two-day face-to-face
meeting in January 2014 (Arlington, Virginia), and in April 2014 (Longmont, Colorado), and a
final face-to-face meeting in July 2014 (Arlington, Virginia), to facilitate discussion on the
deliverables.
Working Group 5 reviewed approximately 600 cybersecurity BPs to determine whether or not
they were within scope of the Working Group’s tasking (i.e., BPs to mitigate server-based DDoS
attacks). The Working Group reduced the applicable list to approximately 30 salient BPs. The
Working Group conducted a gap analysis using The Six Phases of DDoS Attack Preparation and
Response in parallel with the NIST Cybersecurity Framework. Based on the gap analysis, the
Working Group has also written several new BPs for voluntary adoption by the communications
12 http://www.darkreading.com/attacks-and-breaches/bank-attackers-used-php-websites-as-
launch-pads/d/d-id/1107833?
13 http://www.pcworld.com/article/2040766/possibly-related-ddos-attacks-cause-dns-hosting-
outages.html
Page 11The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
industry.
The Working Group also identified barriers to implementation of the BPs based upon the
experiences summarized in the subgroup case studies, as well as member experience, and
considered outcome-based measures of effectiveness that demonstrate whether or not the
voluntary efforts towards server-based DDoS attacks are having a favorable effect. The Working
Group also applied the Six Phases taxonomy (Appendix A) as a guide in identifying candidate
best practices for implementation.
Finally, the Working Group provided recommendations in terms of actions the FCC can take to
help mitigate the effects of DDoS attacks by enabling broader adoption of the recommended
server-based DDoS best practices.
3.3 Metrics
Measures of success against server-based DDoS attacks are critical in determining the
effectiveness of following the best practices recommended in this report. Working Group 5
members recognize that agreement upon a consistent, uniform approach to measuring the
effectiveness of following the recommended BPs will lay the foundation for determining if
additional voluntary actions are needed across the ecosystem in order to holistically address
server-based DDoS attacks.
Working Group 5 also recognizes that effective measures can be difficult to achieve. Network
Operators each have differing methods to deal with DDoS attacks. Establishing common
measures of success requires that the participants establish a uniform approach in collecting,
interpreting, analyzing, and reporting DDoS attack metrics. In order to measure the
effectiveness of following the recommended server-based DDoS attack BPs, the metrics must be
carefully chosen to measure the desired outcome in a meaningful, measurable, and repeatable
way. Careful analysis of the aggregate metrics across the ecosystem, and inference regarding
effectiveness of implementing the recommended BPs, requires participation and cooperation
amongst all ecosystem stakeholders who contribute to the collection, analysis, reporting, and
interpretation of the metrics.
In order to involve the broader ecosystem participants in the formation of a uniform approach to
measuring the effectiveness of implementing the recommended BPs, Working Group 5 has
partnered with CSRIC IV’s Working Group 4, Cybersecurity Best Practices, in order to leverage
their 100 plus members, to holistically address metrics to measure the effectiveness of
implementing the recommended BPs, not only for server-based DDoS attacks, but for other
recommended cybersecurity BPs as well. Working Group 5 members will liaison with the
members of Working Group 4 on completing this holistic metrics effort for inclusion in the
Working Group 4 deliverable in March 2015.
As part of the Working Group 4 effort on metrics, Working Group 5 will recommend potential
server-based DDoS attack metrics that could be considered as test cases for consideration across
the ecosystem participants. These measures Working Group 5 members will identify to
Working Group 4 will be important to measure the effectiveness of following the recommended
server-based DDoS attack BPs across the ecosystem and are conceptually tenable trial measures
Page 12The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
for a disciplined review process to be established by Working Group 4.
3.4 Barriers to Participation
The following sections address Working Group 5 efforts regarding Barriers to Participation by
Network Operators in adoption of the recommended best practices presented in this document.
These sections are largely adapted from CSRIC III’s Guide to ISP Code Participation14 as the
barriers identified in following the CSRIC III Working Group 7’s recommended U.S. Voluntary
Anti-Bot Code of Conduct for ISPs is applicable to barriers Network Operators may encounter
in following Working Group 5’s recommended server-based DDoS attack BPs. In addition to
Network Operators, Hosting Providers, to the extent the recommended BPs apply, may also
encounter similar barriers. The prior work accomplished by CSRIC III provided suitable
definitions and framework for Working Group 5’s approach to barriers.
Many of the recommended best practices provided in this final report involve varying levels of
commitment and complexity. It is understood that private sector participants compete internally
for investment capital and human resources, and that decisions to prioritize such investments are
increasingly dependent upon providing a solid business case to the decision-makers.
The Barriers Guide is designed to encourage broader participation by providing a structured set
of resources related to specific recommendations including the best available guidance on
implementation.
3.4.1 Barriers to Participation: Considerations
Best practice adoption can pose barriers to the extent that the requisite activities impact existing
methods and procedures and the resources of multiple organizations. Network Operators will
need to understand not only what changes may be required, but which organizations would be
impacted from a process, resource, and budget perspective. Consideration must be given to
scalability and the levels of inter-departmental integration as well as any on-going support
required to implement a recommendation. In addressing barriers, efforts were made to categorize
each identified barrier into one of the following categories:
3.4.1.1 Technology Barriers
Technology barriers are barriers where current technical solutions may be insufficient to tackle
the threats or where those solutions may have other unacceptable side effects. The significance
of technology solutions as barriers depends on the degree to which technology is required to
implement a specific recommendation. Some solutions may require minimum technical
resources (assets and people) while others might be more demanding including levels of systems
integration. Implementing a recommendation is also likely to depend on the current “as-is”
situation within a Network Operator including internal capabilities, resources and priorities or
access to third-party resources. Technology barriers may directly translate into financial
14
http://transition.fcc.gov/bureaus/pshs/advisory/csric3/CSRIC_III_WG7_Report_March_%20201
3.pdf
Page 13The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
barriers. A technical solution may exist but the cost to implement it in the Network Operator
may be prohibitive.
3.4.1.2 Customer/Market Barriers
Customer or Market Barriers are barriers that arise out of implementing solutions that may be
viewed by customers as ineffective (e.g., customers choosing not to participate) or undesirable
(e.g., privacy, restrictive terms and conditions). Network Operators’ activities may also have
consequences in the marketplace by raising costs for their products, the amount of capital
investment a Network Operator is willing to make, the willingness of customers to purchase the
solution, and other considerations in relation to competing products. Implementing some best
practices which are offered as managed security services will be a business decision by the
Network Operator. They will need to decide if they wish to offer those services, and if they do,
if they wish to implement them internally or through a third party. Finally, they will need to
decide on the scope, features, capacity and price of the managed security services offering that
best meets the marketplace where they compete.
3.4.1.3 Operational Barriers
Operational barriers are barriers that could have an unacceptable impact on an organization’s
primary mission and resources. Organizations that have operational responsibilities are
typically held accountable through well-defined performance measurements. (e.g., average
transaction time for customer care representatives). Any new operational practice must be
implemented with sufficient attention to:
• development and updated operational methods and procedures;
• reallocation of existing or additional resources;
• scalability of solutions;
• operational performance goals, critical success factors and ability to measure results.
3.4.1.4 Financial Barriers
Financial barriers result from any inability to quantify costs or benefits associated with
implementing specific recommendations. In the current economic environment, the absence of a
company-specific business case may be a significant barrier to adoption. Private sector
companies have a fiduciary responsibility to make decisions based on the prudent allocation of
capital. When it comes to deployment of investments in security-related technologies, most
companies rely on quantifiable data to prioritize and allocate new investment in systems,
processes, and human resources.
3.4.1.5 Legal/Policy Barriers
Laws that discourage collaboration and information-sharing among Network Operators, either in
the U.S or abroad, can give cover to malicious actors.15 Malicious actors have the ability to
15 See id.
Page 14The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
disguise botnets as legitimate traffic, which places security professionals in the untenable
position of potentially intruding upon an end-user’s expectation of privacy or allowing
dangerous and costly criminal activity to take place.16 Furthermore, Network Operators are not
always able to stop traffic even if it is recognized as malicious. For example, the traffic could be
interwoven with commercial activity, such that the cost of mitigation would be greater than the
harm posed by the botnet. Network Operators face a continuous balance between providing
protection for their customers while guarding the privacy of customers and respecting the
autonomy expected by other Network Operators.
3.4.1.6 Barriers - Server Based DDoS Attacks
DDoS attacks originating from data centers and Hosting Providers are especially problematic
because of the high bandwidth and computational resources available to an attacker. This makes
prevention, detection, and mitigation more important, yet more difficult. Server based DDoS
attacks require ecosystem involvement, even to a greater degree than other types of attacks.
These aspects of Server based DDoS attacks result in particular barriers to dealing with the
attacks. Several new best practices are provided in this report to address theses aspects along
with salient existing and updated best practices. In general, the following are statements on
considerations particular to server based DDoS attacks:
3.4.1.6.1 Technology Considerations:
Some of the best practices identified in this document are difficult or not possible to implement
without impact in some networks, dependent on network architecture. Some best practices
outlined in this document depend in part on technology available in some network device
platforms, but not others.
3.4.1.6.2 Customer/Market Considerations:
Some best practices, while very effective, are additional services that customers must purchase
and configure. Attack mitigation controls may well interfere with legitimate traffic, which may
be deemed unacceptable to a customer.
3.4.1.6.3 Operational Considerations:
While many best practices are not difficult to implement themselves, implementation at a scale
of thousands of customers introduces significant complexity in terms of configuration
management and back-office systems. Some mitigation techniques could cause collateral
damage to other customers in the same data center, which may be deemed unacceptable to data
center operators. Many of the operational changes recommendations require coordination
between Network Operators and their customers to avoid outages. This is a significant time
investment and can also lead to customer retention issues if the customers do not directly benefit
from the implementation.
3.4.1.6.4 Legal/Regulatory/ Policy Considerations:
16 See generally, Can We Beat Legitimate Cyber Behavior Mimicking Attacks from Botnets?,
IEEE (2012).
Page 15The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
Data sharing between providers can be more difficult in some countries with stringent local
privacy laws. Liability issues may also exist regarding inaccurate data shared during an attack.
3.4.1.6.5 Financial Considerations:
Many of the best practices in this document depend on specific capabilities and feature sets that
are not ubiquitous among routers. Implementation may require new equipment to be purchased
by the Network Operators, Hosting Providers, or customers.
Implementation of some of the identified best practices may impact the performance of network
equipment or servers. This may in turn require more powerful or more numerous devices,
making services more expensive for all customers.
4 Background
Prior CSRICs have recommended Best Practices that could be used to mitigate DoS and DDoS
attacks. CSRIC II approved Working Group 8’s recommendations from their final report ISP
Network Protection Practices:17
• Recommended best practices (BPs) in areas of prevention, detection, notification,
mitigation, and privacy considerations
• Focused on BPs for ISPs that provide services to consumers on residential broadband
networks, but noted many of the best practices identified in the report would also be
valuable practices to apply in non‐consumer, non‐residential network contexts
• Further recommended that, at a later date, the FCC consider whether additional best
practice work would be valuable in the nonresidential context.
CSRIC II also approved the Working Group 2A’s recommendations from their final report
Cyber Security Best Practices:18
• Updated Cyber Security Best Practices reflective of the current technology environment
within the Communications’ Industry, and related references by:
Analyzing existing NRIC, NIST, SANS, IEEE, etc. best practices related to Cyber
o
Security
Recommending modifications and deletions to those existing Best Practices
o
Identifying new Cyber Security Best Practices across existing and relatively new
o
technologies within the Communication industry.
CSRIC III approved Working Group 7’s recommendations from their final report U.S. Anti Bot
Code of Conduct for ISPs (ABCs for ISPs):19
• Focused on botnet threat from residential broadband devices ‐
• Recommended voluntary ISP actions in areas of education, detection, notification,
remediation, and collaboration
17
http://www.fcc.gov/pshs/docs/csric/CSRIC_WG8_FINAL_REPORT_ISP_NETWORK_PROT
ECTION_20101213.pdf
18 http://www.fcc.gov/pshs/docs/csric/WG2A-Cyber-Security-Best-Practices-Final-Report.pdf
19 http://transition.fcc.gov/bureaus/pshs/advisory/csric3/CSRIC-III-WG7-Final-ReportFinal.pdf
Page 16The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
• Further recommended the FCC, working in partnership with other federal government
agencies and industry, facilitate the creation of case studies on botnet mitigation
activities
CSRIC III approved the Working Group 4’s recommendations from their final report DNS Best
Practices:20
• Focused on Best Practices to secure DNS and routing system for the Internet during the
period leading up to the implementation of DNSSEC.
CSRIC III also approved the Working Group 5’s recommendations from their final report
DNSSEC Implementation Practices for ISPs:21
• To examine best practices for deploying and managing the Domain Name System Security
Extensions (DNSSEC) by Internet service providers (ISPs).
• Recommend proper metrics and measurements that allow for evaluation of the effectiveness
of DNSSEC deployment by ISPs.
Recent DDoS attacks have exploited vulnerabilities in web‐hosting companies and other large
data centers to launch DDoS attacks on computer systems and websites.22 CSRIC IV
recognized that work in this area is both timely and important in order to impact these latest
DDoS threats. Based upon the progress made in the prior CSRICs focused on residential
networks, CSRIC IV Working Group 5 was given the charter to recommend measures
communications providers can take to mitigate the incidence and impact of DDoS attacks from
data centers and Hosting Providers, particularly those targeting the information systems of
critical infrastructure sectors.
5 Analysis, Findings, and Conclusions
5.1 Analysis
The case studies looked at a number of server-based DDoS attacks. An attack can involve
multiple ISPs and multiple data and hosting centers.
• Anatomy of a Server Based DDoS Attack
As shown in Figure 3, an attacker can gain control of data center and hosting servers and
leverage the sizable computational and network resources to launch a DDoS attack on an
enterprise victim. Note that the target could also be part of the ISPs’ infrastructure. This attack
overwhelms access to the target, denying access from legitimate users as well as causing
20
http://www.fcc.gov/bureaus/pshs/advisory/csric3/CSRIC_III_WG4_Report_March_%202013.p
df
21
http://www.fcc.gov/bureaus/pshs/advisory/csric3/CSRIC_III_WG5_Report_March_%202013.p
df
22 http://www.darkreading.com/attacks-and-breaches/bank-attackers-used-php-websites-as-
launch-pads/d/d-id/1107833?
Page 17The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
collateral damage by affecting other parties along the DDoS traffic path. Mitigation of this type
of attack requires action by all the parties involved:
- Multiple ISPs
- Hosting Providers / Data Centers / Resellers
- Target infrastructure
- ISP infrastructure of the originating attacker
Figure 3 – A Server Based DDoS Attack.
Source:
http://www.cisco.com/web/about/security/intelligence/guide_ddos_defense.html#_Toc374453043
• Attack Taxonomy – A taxonomy of the types of server-based DDoS attacks was created
in order to determine the scope of defenses that would be needed to mitigate the attacks.
The attack taxonomy is contained in Appendix C.
• Case Studies
Working Group 5 identified three subgroups to focus attention on stakeholder
o
server-based DDoS attack case studies and a fourth subgroup to conduct an
industry best practices analysis. The subgroups were: ISPs, Financial
Page 18The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
Community, Internet Security Experts, and Best Practices subgroups.
The Best Practices subgroup identified applicable BPs for DDoS server-based
o
attacks while the ISPs, Financial, and Internet Security Experts subgroups
developed representative case studies for server-based DDoS attacks. The case
studies are included in Appendix D.
• Recommended Best Practices
Best Practices are included in Appendix E
o
5.2 Findings
Key Findings from Case Studies:
1. DDoS attacks are becoming large enough to overwhelm a single ISP’s ability to absorb.
2. Server-based attacks harness data center computational and networking resources to
stage DDoS attacks of unprecedented volume.
3. Because of the increased volume of DDoS attacks, collateral damage (impacts to others
not targeted by DDoS attack) is common – packet loss, delays, high latency for Internet
traffic of uninvolved parties whose traffic simply happens to traverse networks saturated
by these attacks.
4. DDoS attacks are being used not only to disrupt services, but to distract security
resources while other attacks are being attempted, e.g., fraudulent transactions.
5. Adaptive DDoS attacks are prevalent. Attackers vary attack traffic on the fly to avoid
identification and to challenge and confuse mitigation strategies.
6. Reflective and amplification attacks are still common, leveraging misconfigured DNS,
NTP, and other network resources with the ability to spoof (forge) source (target) IP
addresses.
7. The botnet architecture is becoming more sophisticated and difficult to trace and
command and control (C2) systems are increasingly tiered using proxy servers and peer
to peer networking to obfuscate the location of the system that is executing the
commands. Additionally, some botnets have the ability to impair a compromised system
after it has completed an attack.
8. Devices are increasingly spread out globally making the coordination of shutting down
these systems difficult due to the fact that countries often have different and sometimes
conflicting laws.
9. DDoS traffic builds quickly so automated mitigation capabilities are needed to protect
the infrastructure.
10. In order to support automated mitigation capabilities, a standardized taxonomy to
express information required to mitigate DDoS server-based attacks needs to be
followed.
11. Anti-spoofing (anti-forging) technologies need to be more widely deployed to protect
against amplification attacks.
12. DDoS mitigation capability needs to be deployed throughout the network since it is
difficult to predict where the attack will originate.
13. DDoS mitigation requires multiple tools. ISPs need destination blackhole filtering
capability to protect their networks recognizing that blackhole filtering completes the
Page 19The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
DDoS attack to the target. Attack mitigators need multiple types of less intrusive
capabilities to minimize the effectiveness of DDoS attacks.
14. DDoS attacks need to be addressed by the entire networking ecosystem, not just the
Network Operators. This includes hosting center and data center providers, the DDoS
targets, software vendors, open source organizations, as well as equipment manufacturers
(the entire supply chain).
15. DDoS mitigation requires close cooperation of targets, Hosting Providers, and the
Network Operators. As new DDoS mitigation techniques become more effective,
attackers will continue to adapt their techniques to find new ways to attack their targets.
16. The development of potential success measures to determine the effectiveness of
following voluntary server-based DDoS attack best practices must be addressed not only
by Network Operators, but by the broader Internet ecosystem stakeholders in order to
provide meaningful, holistic interpretations of effectiveness.
5.3 Conclusions
In this final report, Working Group 5 has documented its findings, made recommendations,
suggested best practices to address server-based DDoS attacks, addressed barriers to
implementation, and suggested a path forward to holistically address measures of effectiveness
for following the recommended BPs. We conclude in this final report that action will be
required, not only by Network Operators, but by the entire ecosystem of stakeholders impacted
by server-based DDoS attacks, in order to prevent, detect, and mitigate the attacks.
6 Recommendations
1- FCC encourage ISPs to consider voluntary implementation, in a prioritized manner,
of the recommended best practices and new recommendations (Appendix E) to
address server-based DDoS attacks by promoting awareness and benefits of these
best practices.
2- FCC encourage the development of best practices for Hosting Providers to promote
safe computing practices, reduce vulnerabilities, and reduce the threat of exploiting
vulnerabilities, thereby reducing incidence of server-based DDoS attacks.
3- FCC encourage voluntary, private sector relationships, to the extent they do not exist
already, between peers to collaborate on DDoS response best practices and
mitigation support.
4- FCC encourage the development of a voluntary central clearing house for DDoS
mitigation information within the existing DHS information sharing structure that
can be a resource among ISPs, Hosting Providers, targets, response organizations
(CERTS & ISACs) and governments to mitigate DDoS attacks in real time.
5- FCC encourage ecosystem stakeholders to share DDoS server-based attack
information between themselves or through a centralize clearing house using a
standardized taxonomy, such as the Structured Threat Information eXpression
(STIX)23 or a similar construct, to assist in automated mitigation of the attacks.
6- FCC encourage the sharing of DDoS mitigation best practices, threat, vulnerability,
23 https://stix.mitre.org/
Page 20The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
and incident response actions among Network Operators in the Comm-ISAC.
7 Acknowledgements
This final report reflects the invaluable contributions of all the working group members. The
Working Group 5 Co-Chairs, Michael Glenn of CenturyLink and Peter Fonash of DHS, would
like to express their appreciation to all the Working Group 5 members for their hard work, time,
and tremendous efforts that culminated in this final report. The Co-Chairs would like to
recognize the tireless efforts of the editors, Paul Diamond of CenturyLink and Robert
Thornberry of Bell Labs, Alcatel Lucent for their outstanding dedication in developing the
interim and final reports. The Co-Chairs would also like to recognize the following individuals
who served as leaders of the important subgroups’ efforts:
• ISPs – Jared Allison of Verizon and Chris Boyer of AT&T
• Financial – John Denning of the Bank of America and Errol Weiss of the Financial
Services Sector Coordinating Council (FSSCC)
• Internet – Roland Dobbins of Arbor Networks
• Best Practices – Robert Thornberry of Bell Labs, Alcatel-Lucent
The Co-Chairs would like to thank Vernon Mosley of the Federal Communications Commission
for his considerable efforts in facilitating the production of the report. The Co-Chairs would
also like to thank the hosts for the face-to-face meetings, CenturyLink and Intrado. And the Co-
Chairs would also like to thank John Levine of CAUCE for establishing and maintaining the
WG5 wiki and listserve.
And the Working Group 5 members would like to acknowledge the outstanding leadership of
the Co-Chairs, Michael Glenn and Peter Fonash, for keeping the working group focused and for
creating a high-performance team environment in which to contribute to the server-based DDoS
attack mitigation recommendations.
8 Appendices
Appendix A: Six Phases of DDoS Attack Preparation and Response Taxonomy
Appendix B: Server-Based DDoS Glossary
Appendix C: DDoS Attack Taxonomy
Appendix D: DDoS Attack Mitigation Case Studies
Appendix E: Server-Based DDoS Mitigation Best Practices
Page 21The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
Appendix A: Six Phases of DDoS Attack Preparation and Response Taxonomy
Page 22The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
Preparation
Communication
ISP & Pure Play DDoS
Mitigation Company (PP)
ISP/PP to ISP/PP
ISP/PP to Hosting
ISP/PP to Victim
ISP/PP to Central Coordination
Center
Hosting
Hosting to ISP
Hosting to Hosting
Hosting to Victim
Hosting to Central Coordination
Center
Target
Victim to ISP
Victim to Hosting
Victim to Victim
Target to Central Coordination
Center
Monitoring & Visibility
ISP
Netflow
Traffic Levels
Server Infrastructure Resource Levels
Route Hijacking
FW, router, server logs
Hosting
Netflow
Traffic Levels
Server Infrastructure Resource Levels
ISP attack signaling
FW, router, server logs
Target
Server Infrastructure Resource Levels
ISP attack signaling
FW, router, server logs
Page 23The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
Prevention
ISP
Anti‐spoofing techniques
Reduce Reflective Surfaces
Rate Limits / Traffic Blocking
Hosting
Anti‐spoofing techniques
Reduce Reflective Surfaces
Rate Limits / Traffic Blocking
Server Resource Minimization Plan
and Procedures
Target
Server Resource Minimization Plan
and Procedures
Deploy and Configure
Mitigation Tools
ISP & Pure Play DDoS
Mitigation Company
Filtering
CDN Filtering (Web traffic attacks)
BGP Flowspec
Black Hole Filtering (Source and
Destination)
Network Data Scrubbing
Hosting Filtering
On‐site data scrubbing
Target Filtering
On‐site data scrubbing
Page 24The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
Capacity and Resources
ISP
DNS server
DNS Network Capacity
BGP Link, Router and State
Protection
Hosting
DNS server
DNS Network Capacity
BGP Link, Router and State
Protection
Data Center Uplink Bandwidth
FWs, IDS/IPS, Switch capacities
Target
Server and Network Uplinks
FWs, IDS/IPS, Switch capacities
Server resource capacities
Minimize Attack Service
ISP
Close Open DNS Resolvers
Rate limit DNS queries
Rate limit open protocols (NTP, Echo,
etc)
Turn off unnecessary protocols on
network infrastructure
Hosting
Close Open DNS Resolvers
Rate limit DNS queries
Rate limit open protocols (NTP, Echo,
etc)
Turn off unnecessary protocols on
network infrastructure
Turn off unnecessary protocols on
server & virtual infrastructure
Target
Page 25The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
Turn off unnecessary protocols on
server & virtual infrastructure
Peering and Upstream
ISP cooperative
mitigation agreements
Formal and informal
mitigation agreements
Identification of 24/7
operational contacts at
peer or upstream ISPs for
attack mitigation
assistance
Page 26The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
Identification
Monitoring & Visibility
ISP
Netflow (with router and interface
information)
Traffic Levels
Server Infrastructure
Route Hijacking
FW, router, server logs
Full Packet Capture and Analysis
Hosting
Netflow (with router and interface
information)
Traffic Levels
System loads
ISP attack signaling
FW, router, server logs
Full Packet Capture and Analysis
Target
System loads
ISP attack signaling
FW, router, server logs
Full Packet Capture and Analysis
Confirm with target
(customer) that the
traffic is truly attack
traffic.
Classification
Type of attack
Volumetric Attack?
Direct Packet Flood
Reflection/Amplification
Application Layer Attack?
State or Resource
Exhaustion Attack?
Control Plane Attack?
Ipv6 Specific Attack?
Page 27The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
Traceback
Identification of source
IPs
Identification of ingress
router interfaces
Identification of DDoS
Packet Paths
Intermediate traffic loads
Identification of Reflective
Surface (routers, servers,
etc)
Identification of ingress router
interfaces for spoofed reflective
packets
Reaction
Determine best tool or set
of tools to mitigate the
attack
Analyze residual traffic
going to target fine tune
mitigation filters and
changes in attack traffic
and methods
Monitor filtering methods
to minimize false positive
traffic errors
Is help needed from peer
or upstream providers to
mitigate the attack?
Page 28The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
Post Mortem
How quickly was the
attack identified and
classified?
Were the tools effective
in mitigating the attack?
Are there any additional
preventative measures
that can be put in place to
prevent future attacks?
Are there any additional
mitigation measures that
can be put in place to
more effective mitigate
future attacks?
Were communications
timely and effective?
Were mutual ISP
assistance agreements
needed? Effective?
Page 29The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
Appendix B: CSRIC IV WG5 Server-Based DDoS Glossary
(This glossary combines glossaries from CSRIC III WG7 Final Reports as a baseline.)
I. Terms:
1. Blackhole Filtering / Blackhole Routing
A technique used to drop network traffic based on either source or destination IP address.
Blackhole filtering/routing is typically used to mitigate a DoS or DDoS attack by a Network
Operator. The technique can be deployed at edge, border, or core routers to efficiently drop
attack traffic close to network ingress points to minimize the effects of an attack on the network
or other customer’s traffic.
2. Bot
A malicious (or potentially malicious) "bot" (derived from the word "robot", hereafter simply
referred to as a "bot") refers to a program that is installed on a system in order to enable that
system to automatically (or semi-automatically) perform a task or set of tasks typically under the
command and control of a remote administrator (often referred to as a "bot master" or "bot
herder.")
Computer systems and other end-user devices that have been “botted” are also often known as
"zombies".
Malicious bots are normally installed surreptitiously, without the user's consent, or without the
user's full understanding of what the user's system might do once the bot has been installed.
Bots are often used to send unwanted electronic email ("spam"), to reconnoiter or attack other
systems, to eavesdrop upon network traffic, or to host illegal content such as pirated software,
child exploitation materials, etc.
Many jurisdictions consider the involuntary infection of end-user hosts to be an example of an
unlawful computer intrusion.
3. Botnet
Botnets are networks of Internet-connected end-user computing devices infected with bot
malware, which are remotely controlled by third parties for nefarious purposes.
A botnet is under the control of a given "botherder" or "botmaster." A botnet might have just a
handful of botted hosts, or millions.
4. Communication Provider
Communications Providers consist of Internet Service Providers, Service Providers, Network
Operators, Hosting Center Operators, Data Center Operators, and the manufacturer ecosystem
that supports these providers.
5. Customer (or "Direct Customer")
The party contracting with an ISP for service. Distinguish the "customer" from an "authorized
user:" for example, a coffee shop might purchase Internet service from an ISP. The coffee shop
would be the ISP's customer. The coffee shop might elect to offer free use of its connection (if
Page 30The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
permitted by the ISP's Acceptable Use Policy, or AUP) to those who buy coffee from it -- coffee
buyers would then be authorized users of the connection purchased by the coffee shop, but not
the ISP's direct customer.
6. Data Center
A facility dedicated to housing large amounts of computing and networking resources in an
environment providing high availability power and networking capabilities.
7. Data Scrubbing
Routing DoS or DDoS attack traffic to a system or service that tries to differentiate “good”
network traffic from attack traffic and dropping the attack traffic while passing the good traffic.
Data scrubbers can be deployed in Network Operators’ networks or on customer premises. For
attack traffic greater than the bandwidth to customer premises, network based data scrubbers
are needed to effectively mitigate the attack.
8. Denial of Service (DoS) or Distributed Denial of Service (DDoS) Attack
A denial-of-service (DoS) or distributed denial-of-service (DDoS) attack is an attempt to prevent
legitimate users from accessing information or services24 (US-CERT).” A distributed denial of
service attack consists of two or more systems or attackers engaged in the attack at the same
time to the same target.
9. Detection
Detection is the process whereby a service provider or end-user comes to be aware that a
particular system or device has been infected with malicious software. A service provider may
detect that a system has become infected many different ways, including as a result of
receiving complaints from third parties about spam, network scanning, or attacks that have
been sourced from that system. End-users may detect system infections through software
tools or other means.
10. Ecosystem
This term is often used to describe the interrelationship of various Internet participants—the
hardware manufacturers, software developers, ISPs, and providers of various Internet content,
applications, and services that make the Internet work and be useful for end-users.
The internet ecosystem includes operating system vendors, end-user focused organizations,
providers of Internet content, applications, and services, ISPs, search providers, end-users, IT
departments, hosting companies, blog providers, security vendors, researchers, government,
financial services companies, and other parties.
The so-called "underground economy" is also often described as an "ecosystem," with multiple
participants filling diverse specialized roles. For example, some participants may specialize in
writing malware, while others may "harvest" email addresses from web pages and mailing lists,
while still others may specialize in distributing malware to those harvested email addresses.
The malware ecosystem will also normally include the population of targeted potential victims,
and law enforcement agencies working to combat cybercrime.
24 http://www.us-cert.gov/ncas/tips/ST04-015
Page 31The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
11. End-user
End-User: In a computing and networking context, the end-user is the person who ultimately
makes authorized use of a product or service.
The end-user may often not be the same as the person who may have purchased the product
or service. For example, a coffee shop owner may purchase connectivity for use by his or her
customers; in that scenario, the coffee shop customers, and not the coffee shop owner,
represent the actual "end-users," even though they did not directly contract with an ISP for the
connectivity they're using.
A party, such as a hacker/cracker who makes use of a product or service without the
authorization of the purchaser, would normally be considered a cyber intruder and not an "end-
user" per se.
12. Hosting Center / Hosting Provider
Hosting centers offer various kinds of hosting services which may range from managed hosting
utilizing computing, network, and management resources provided by the hosting center
operator, to collocation hosting which allows tenants to provide their own equipment housed in
the hosting operator racks.
13. ISP
An Internet Service Provider (ISP) is a company that provides retail access to the Internet for
members of the public, or for businesses and other organizations. Those connections may be
via cable, DSL, satellite, wireless, dialup, or other technologies. ISPs are sometimes also
known as "access providers."
An enterprise that provides access to the Internet solely for its own employees would not
normally be considered to be an ISP. Likewise, a network carrier that only provides wholesale
access to the Internet for other ISPs would normally be considered to be a network service
provider (NSP), rather than an ISP.
14. Malware
"Malware" is short for "malicious software."
Malicious bots are one type of malware. Other forms of malware include categories of software
known as viruses, Trojan horses, worms, rootkits, crimeware, keystroke loggers, dialers,
spyware, adware, etc. The factors that distinguish those different types of malware are less
important than an understanding of why malware may be viewed as "malicious."
Malware often violates one or more of the following fundamental principles:
(a) Consent: Malware may be installed even though the user did not knowingly ask for that to
happen.
(b) Honesty: Malware may pretend to do one thing, while actually doing something completely
different.
(c) Privacy-Respectfulness: Malware may violate a user's privacy, perhaps capturing user
passwords or credit card information.
Page 32The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
(d) Non-Intrusiveness: Malware may annoy users by popping up advertisements, changing web
browser's home page, making systems slow or unstable and prone to crash, or interfering with
already installed-security software.
(e) Harmlessness: Malware may be software that hurts users (such as software that damages
our system, sends spam emails, or disables security software).
(f) Respect for User Management: If the user attempts to remove the software, it may reinstall
itself or otherwise override user preferences.
It all adds up to "software users just don't want."
Users may unknowingly install malware by opening a tainted attachment received by email, or
by visiting a web page that has malicious content. Systems may also be directly infected by a
remote attacker as a result of the attackers targeting a known vulnerability that may be remotely
exploitable, or by the user mounting an infected CD, DVD, or thumb drive.
15. Mitigation
Mitigation is the process of managing or controlling the effects associated with a bot. For
example, if a system is infected with a spam bot, and is spewing unwanted commercial email,
mitigation may consist of filtering the spam that is being emitted from that device.
Mitigation can also involve blocking, limiting access to, or rate limiting services on devices that
can be used in a reflective DDoS attack.
Note that mitigation typically does not involve fixing the underlying condition (that would be
"remediation"); mitigation just manages the symptoms associated with a condition.
16. Network Operator
An organization that provides network services for Internet access in the wired or wireless
arena. ISPs, telecommunications companies, cable companies and Hosting Providers may be
examples of Network Operators if they provide these services.
17. Notification
Notification is a process whereby ISPs communicate with their end-users regarding the
possible infection of the end-user’s device by bot malware or how a subscriber can prevent or
identify such an infection. Notification may also entail a process whereby end-users are
directed to tools that will enable self-discovery of bot infections. Notification can take different
forms, including direct notification by the ISP to the end-user, or indirect notification through
available self-discovery tools or a third party. Notification may be done via multiple potential
channels, including (but not limited to) e-mail, postal mail, a phone call, in-browser notification,
web-based self-discovery tool, or SMS message.
18. Prevention
Prevention is the process of hardening a system or service so that it is less vulnerable to
compromise and exploitation. For example, on many systems, prevention may involve:
— Patching the operating system and all applications with available security fixes
Page 33The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
— Installing or enabling a firewall
— Using anti-virus software
— Making sure the system is regularly backed up
— Using strong passwords
— Disabling or preventing access to unneeded network services
— Encouraging users to safely use internet services (e.g., e-mail, web browsing,
etc.)
19. Reflective DDoS Attack
A DDoS attack that forges the source address of the attack IP packets with the victim’s IP
address and sends the IP packets to intermediate hosts. When the intermediate host responds
to these packets, the response packets are sent to the victims IP address, flooding the victim
with traffic from the intermediate hosts. Typically in this type of attack, intermediate hosts and
protocols are used where the response packet is larger than the request packet, amplifying the
network traffic sent to the victim.
20. Remediation
Remediation is the process that an end-user goes through to clean up a botted computer so
that it is no longer infected. In easy cases this may involve installing and running an anti-virus
product. In more difficult cases, remediation may involve more substantial intervention up to
"nuking and paving" the system -- formatting it and reinstalling it from scratch, or at least from
the last known-clean backup. Once the system is clean, or has been reinstalled, it will then
normally be hardened to protect it from reinfection.
21. Server
A network server is a computer designed to process requests and deliver data to client
computers over a local network or the Internet. Servers in data centers and hosting centers
typically have high bandwidth connections to the network and have substantial computational
resources to process large numbers of requests in a short period of time.
22. Spam
Unwanted and unrequested e-mail, often commercial in nature, normally sent to a large number
of recipients in substantially identical form. Spam is often sent by "affiliates" who are paid by the
person running the affiliate program when recipients purchase the spamvertised product.
II. The Infection Lifecycle:
1. Clean: For the purposes of the ISP voluntary Anti-Botnet Code of Conduct, a computer or
other networked device will be considered "clean" when it (a) exhibits no externally discernible
symptoms of infection (such as sending spam, participating in a distributed denial of service
attack, or contacting a known command and control host), and (b) a review of the computer or
other networked device with a generally accepted commercial or free/open source anti-virus
program (using the most recently available definitions) finds no infection, and (c) the computer
Page 34The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
or other device otherwise appears to be operating normally in all respects. A newly purchased
system shall be presumed to start in a clean status "out of the box," absent evidence to the
contrary.
2. Vulnerable: A computer or other networked device shall be deemed "vulnerable" when it has
one or more flaws or misconfigurations that render it potentially susceptible to compromise,
infection or use as a reflective media in a DoS or DDoS attack. A common example of a
vulnerable device is one that hasn't been patched, or which uses an easily guessed password
for access. Note that a system may be "clean" yet "vulnerable" simultaneously, as in the case
where a vulnerable system is protected by a compensating control (such as a firewall), thereby
allowing the system to avoid becoming infected or compromised despite the presence of one or
more vulnerabilities.
3. Infected: An infected computer or infected network device is one that has had malicious
software or malicious firmware installed on/in it without knowing authorization. That malicious
software or malicious firmware may be called a virus, a Trojan horse, a worm, a rootkit, a
keystroke logger, a dialer, crimeware, spyware, adware, etc. A full definition of
"malware" can be found in the glossary appearing in Appendix A to the FCC CSRIC "ABCs for
ISPs."
4. Isolated: A system that is infected or compromised may be isolated to prevent it from
generating unwanted Internet traffic. Isolated hosts are often put into "walled gardens" where
they are limited to accessing a strictly limited set of resources needed for remediation, or are
allowed just to access life-safety services (such as VoIP telephony service for emergency use).
5. Offline: An offline system is one where no network access is allowed to/from that host
whatsoever. Conceptually, think of an ethernet connected host where the ethernet cable has
been disconnected (or the ethernet switch port has been disabled), although obviously different
technical processes are used in the case of cable modem connections, DSL
connections, wireless access, modem access, etc.
6. Disinfected: A system shall be considered "disinfected" when, having been infected, it has
been returned to a "clean" state (as previously defined above). The first step in disinfecting a
system is often installing and running an antivirus product (if one wasn't already installed and
up-to-date). In some cases, it may be necessary to format and reinstall the system from scratch
to overcome particularly well-hidden persistent malware.
7. Hardened: A hardened system is one that has been systematically configured so as to
eliminate the system's vulnerabilities (or potential vulnerabilities). For example, among other
things, a hardened system will be patched up to date, will have all unnecessary services
disabled, will require encryption of all sensitive network traffic, will use strong
passwords or multifactor authentication, will do secure logging to an off-system logging host,
etc.
8. Reinfected: A system that has been disinfected but NOT hardened will often promptly
become reinfected.
9. Compromised: While many vulnerable systems may be compromised as a result of being
infected with malware, other vulnerable systems may be compromised as a result of weak
passwords or misconfigurations (such as critical files that are unintentionally able to be modified
by unauthorized parties). A compromised system is not trustworthy.
10. Managed: A "managed host" is one that is centrally administered, rather than being self-
Page 35The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
administered by the system's user(s). Managed hosts are commonly seen in large corporations,
and in government agencies.
11. Monitored: A monitored host is one that is continually (or at least periodically) scrutinized for
things like anomalous network traffic or unauthorized changes to critical system files.
Monitoring may take place via network security systems, such as Snort, or via host-based
systems such as Tripwire.
12. Replaced: While most users will attempt to disinfect and harden an infected system, some
may elect to replace that system with a new one instead. The prior system may then be sold tor
given to a third party, who may get the system along with any malware installed on it.
13. Shared: A shared system is one that's used by multiple individuals. A common example of a
shared device would be a family device used by a parent or parents as well as by children or
other family members. A shared device often seems to be more prone to infection (or other
security issues) than a system that's used by only a single entity.
14. Orphaned: An orphaned device or orphaned program is an older one for which the vendor
no longer releases even critical security/stability patches. Orphaned systems or programs
generally cannot be hardened.
III. Ecosystem Roles
1. Customer: In the ABCs for ISPs context, the person who is paying an ISP for Internet
service.
2. System Owner: The person who owns a given computer or other device.
3. System User: A person whom the system owner intentionally allows to use their computer or
other device.
4. Support Person: For residential computers, a support person may be a family member or
friend who helps the system owner or user to use and maintain their computer. A support
person may also be a commercial computer support specialist hired for that purpose by the
computer owner or user.
5. ISP Security/Abuse Team: The person or group at an Internet Service Provider who deals
with complaints about a customer.
6. Vendor: The company that manufactured and marketed a computer system or software
program. One might talk about an operating system vendor, an application software vendor, a
hardware vendor, or an antivirus software vendor, for example.
7. Law Enforcement: A police officer, sheriff, federal agent, or other sworn individual with the
power to investigate crimes, gather evidence and make arrests.
8. Regulator: A state or federal official tasked with managing business practices or other activity
so as to ensure fundamental fairness or regulatory compliance. An example of a regulator
would be the U.S. Federal Trade Commission. Regulators normally employ civil sanctions
(such as administrative fines or civil lawsuits) rather than criminal sanctions (such as
arrest/incarceration).
9. Unauthorized User: A person who uses a computer or other device without the intentional
Page 36The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
permission of the system owner, or someone who uses authorized access in excess of their
authorization.
10. Malware Author: The programmer or programming team that designs and codes a piece of
malware, such as a bot.
11. Botmaster: A botmaster is a person who operates a network of botted computers, often
using them to send spam or attack other computers. The botmaster normally sends commands
to "his" or "her" bots via a command and control host, e.g., a server under his or her control.
12. Affiliate: In this context, an affiliate is a person who helps to market a particular product or
service in exchange for compensation, typically using pay-per-impression, pay-per-click, pay-
per-install, or revenue sharing models:
(a) Pay-per-impression (PPI): affiliates are typically website owners who are paid according to
the number of times a web site banner or other advertisement is shown to visitors
(b) Pay-per-click: in this model, affiliates are paid when someone actually clicks on an
advertisement
(c) Pay-per-install: in this model, affiliates are paid when a program supplied to them is installed
on a new system, either surreptitiously or with the knowing consent of the user (perhaps as part
of a "sponsored access" offer for a program or site that would otherwise need to be purchased)
(d) Revenue sharing: in this model, affiliates are paid a percentage of the sales associated with
the customers they refer.
13. List Seller: A list seller is someone who compiles and distributes lists of email addresses.
For example, a spammer who wants to spamvertise an illegal online casino might purchase a
list of email addresses known to be associated with online gamblers.
14. Bullet Proof Hosting Company: A so-called bullet proof hosting company is one that agrees
to host a web site or other online presence notwithstanding complaints that may result from that
activity, typically in exchange for the hosted party paying a premium price. Bullet proof hosting
companies may be used to host spamvertised web sites, malicious software, child abuse
materials, or other content likely to be unacceptable to regular hosting companies.
15. Bullet Proof Domain Name Registrars: A so-called bullet proof domain registrar is one that
allows a spammer or other cyber criminal to register a domain name, and to keep that domain
up, notwithstanding complaints that may be associated with that domain name. This service
normally is provided for a premium over market domain name registration rates.
16. Payment Processor: When an affiliate makes a sale, payment is normally made by credit
card. The entity that processes that credit card transaction is known as a "payment processor."
17. Drop Shipper: A drop shipper is an entity that manages order fulfillment for an affiliate
program. For example, a drop shipper specializing in illegal pharmaceuticals may package and
ship orders obtained by a pill spammer.
18. Online Currency Exchanger: Some affiliates may be paid using an online currency rather
than via a mailed check or direct deposit. Online currency exchangers make it possible for
some to purchase an online currency in exchange for cash, or vice versa.
Page 37The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
19. Abuse Reporter: Third party reporting an abuse incident to an ISP, or through a
clearinghouse (such as a computer security incident response team).
Page 38The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
Appendix C: DDoS Attack Taxonomy
1 DDoS Attacks - Attacking Availability
1.1 Definition of DDoS Attacks
For the purposes of the analysis, the working group used the following definition of a
DDoS Attack: “a denial-of-service (DoS) or distributed denial-of-service (DDoS)
attack is an attempt to prevent legitimate users from accessing information or
services25 (US-CERT).” A distributed denial of service attack consists of two or
more systems or attackers engaged in the attack at the same time to the same target.
1.2 1.2 Goals of DDoS Attacks
1.2.1 Attacks Against Capacity
1.2.2 Attacks Against State
1.3 DDoS Attack Tools
1.3.1 Botnets
1.3.1.1 Client Botnets
1.3.1.2 Server Botnets
1.3.1.3 Participatory Botnets
1.3.1.4 Other Botnets
1.3.2 Attack Harnesses
1.3.3 Traffic-Generation Applications
2 IPv4 & IPv6 DDoS Attacks
2.1 Volumetric DDoS Attacks
2.1.1 Direct Packet-Flooding
2.1.1.1 ICMP & ICMPv6
2.1.1.2 UDP
2.1.1.3 TCP
2.1.1.3.1 SYN-Flood
2.1.1.3.2 RST-Flood
2.1.1.3.3 ACK-Flood
2.1.1.3.4 RST-Flood
2.1.1.3.5 Null-Flood
2.1.1.3.6 SYN/ACK Flood
2.1.1.3.7 XMAS-Tree Flood
2.1.1.3.8 Invalid Flag Combination Flood
2.1.1.3.9 Port 0 Flood
2.1.1.4 Fragmented Packets
2.1.1.4.1 UDP
2.1.1.4.2 TCP
2.1.1.5 Protocol 0
2.1.1.6 GRE (General Routing Encapsulation) flood
2.1.1.7 ESP (IPsec Encapsulating Security Payload) flood
2.1.1.8 RTP flood
2.1.1.9 Other 'Non-Standard' Protocols flood
2.1.2 Reflection/Amplification
2.1.2.1 UDP Reflection/Amplification
25 http://www.us-cert.gov/ncas/tips/ST04-015
Page 39The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
2.1.2.1.1 DNS Reflection/Amplification
2.1.2.1.1.1 DNS Reflection/Amplification with Open DNS
recursers & authoritative Servers
2.1.2.1.1.2 DNS Reflection/Amplification with
Authoritative Servers Only
2.1.2.1.2 SNMP Reflection/Amplification
2.1.2.1.3 NTP reflection/amplification
2.1.2.1.4 Chargen reflection/amplification
2.1.2.1.5 TFTP reflection/amplification
2.1.2.1.6 RADIUS reflection/amplification
2.1.2.1.7 SIP reflection/amplification
2.1.2.1.8 Other UDP reflection/amplification attacks
2.1.2.2 TCP Reflection/Amplification
2.1.2.2.1 SYN/ACK Reflection
2.1.2.2.2 RST Reflection
2.2 Application-Layer DDoS Attacks
2.2.1 HTTP
2.2.1.1 GET
2.2.1.2 POST
2.2.1.3 CGI
2.2.1.4 'Slow' HTTP Variants
2.2.2 SSL/TLS
2.2.2.1Malformed SSL/TLS
2.2.2.2 SSL/TLS Negotiation
2.2.2.3 HTTP/S Encapsulated Attacks
2.2.3 DNS
2.2.3.1 Authoritative DNS Request Floods
2.2.3.2 Recursive DNS Request Floods
2.2.3.3 Authoritative zone delegation attacks
2.3.4 SIP
2.2.4.1 INVITE Floods
2.2.4.2 INFO Floods
2.2.4.3 NOTIFY Floods
2.2.4.4 RE-INVITE Floods
2.3.5 ssh
2.2.5.1 SSH negotiation
2.2.5.2 Login Brute-Forcing
2.3.6 Middle-and Back-Tier Applications
2.2.6.1 AAA Subsystems
2.2.6.2 Databases
2.2.6.3 Image Generation Systems
2.2.6.4 Other Middle- and Back-Tier Applications
2.2.7Other Applications
2.3 State Exhaustion DDoS Attacks
2.3.1 The Role of State in DDoS Attacks
2.3.2 TCP Connection DDoS Attacks
2.3.2.1 Connection Exhaustion
2.3.2.2 Direct Connection Exhaustion
2.3.2.3 Application-Layer Second-Order Connection Exhaustion
Page 40The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
2.4.3 State Exhaustion in Stateful Middleboxes/Middleblades
2.3.3.1 Stateful Firewalls
2.3.3.2 IDS/'IPS'
2.3.3.3 Load-Balancers
2.3.3.4 NATs/CGNs/Proxies
2.4 Control-Plane DDoS Attacks
2.4.1 Routing
2.4.1.1 BGP4 & MP-BGP
2.4.1.2OSPF & OSPFv3
2.4.2 Other Control-Plane Attacks
3 IPv6-Specific DDoS Attacks
3.1 Extension Headers
3.1.1 ICMPv6
3.1.1.1 Neighbor Discovery
3.1.1.2 Router Advertisement
4 Multi-stage attacks
4.1 Flood followed by attacks of mitigation mechanisms
Page 41The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
Appendix D: DDoS Attack Mitigation Case Studies
ISP Subgroup Case Studies
I. Background
Internet service providers (ISPs) have been actively mitigating distributed denial of service
(DDoS)26 for a number of years. In the most common early versions of the attack, personal
computers connected to home broadband services began to experience malware infections that
would transform the machines into so-called zombies (now referred to as bots). Using separately
compromised servers for control, attackers could then command large groups of bots to send
volumes of data at some victim, usually a website. The website would then become
overwhelmed with the incoming data, and would be unable to process normal authorized
requests.
From roughly 1999 to 2011 the volumes of data aimed at most ISP infrastructure, and the skill
with which the volumes of data were crafted by adversaries, were within manageable thresholds.
There have been very few major, service-impacting attacks on any portion of large ISPs
infrastructure during that twelve-year period. This includes attacks on major Tier 1 ISPs
domain name service infrastructure. Attacks during this period were generally sized in the
multiple Gigabit-per-second range.
In addition, during this same time period, some ISPs developed new managed security services
for business customers to help them mitigate DDoS attacks on their own infrastructure. Several
U.S. financial institutions currently subscribe to these services which typically involve real-time
detection of attacks based upon either volumetric or application based solutions. For example, a
DDoS attack could be detected volumetrically based upon traffic spikes using data collection
tools and then redirection of the traffic using the border gateway protocol (BGP) toward
specially designed firewalls that filter the attack. The scrubbed traffic is then "tunneled" to the
customer site over the ISP's infrastructure.
In late 2012 ISPs started to see larger scale attacks by adversaries creating enough inbound
volume to potentially overwhelm the ingress capacity for some ISP's scrubbing infrastructure.
In addition the botnet triggering the attack was unique in that it utilized servers on often sizable
network connections as bots, rather than compromised PCs on consumer broadband connections.
Later in the third quarter, this same adversary launched a series of “telegraphed attacks” on
banking websites with their warnings posted routinely on pastebin. These attacks reached
unprecedented sizes, often again targeting DNS. In response, ISPs made several adjustments in
real time to enhance their infrastructure, scrubbing platforms and DNS site capacity27.
This case study is intended to provide an explanation and proposed practices that ISPs can take
26 A denial-of-service (DoS) or distributed denial-of-service (DDoS) attack is an attempt to
prevent legitimate users from accessing information or services26 (US-CERT).
27 This is an ongoing process of traffic engineering. Many ISPs continually monitor traffic
flows to ensure adequate capacity. This same process applies to data links into ISPs DDoS
scrubbing infrastructure.
Page 42The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
in response to large scale DDoS attacks in the future.
II. Simplified Taxonomy of DDoS Attacks for ISPs
While the broader working group has developed a detailed taxonomy of DDoS attacks, the ISP
sub-group thought it was necessary to develop a simplified version for use with the case study.
The sub-group also discussed a model to classify DDoS attacks in two dimensions:
1. Type of attack - either volumetric or application
2. Direction of the attack - either North-to-South or East-to-West.
a. North-to-South is an attack that originates outside the ISP’s network and targets
an ISP customer or infrastructure inside the ISP’s network.
b. South-to-North is an attack that originates inside the ISP’s network and targets
an external entity or infrastructure inside the ISP’s network.
c. East-to-West represents an attack the originates with a customer and targets
another customer
Examples:
1. Customer or ISP infrastructure being hit from the outside - north-to-south
2. Customers with buggy home gateways flooding ISP DNS servers - south-to-north
3. Customers flooding packets to an external target - also south-to-north
4. Customers attacking each other - east-to-west
The sub-group suggested that we separate out customers attacking each other from customers
attacking infrastructure or external targets because it sometimes requires different detection and
mitigation strategies. For instance, if two customers in the same region attack each other, the
traffic might not cross any of the routers from which the ISPs collect flow data, and it would not
hit scrubbing centers at the ISP’s peering edge.
III. Example DDoS Attacks Experienced by ISPs
A. Server-based volumetric DoS attack against a large customer
Background: This attack used UDP/80 packets (garbage traffic) in high volume to exhaust the
target’s bandwidth. The attack took roughly 10 minutes to reach peak volume of over 70Gbps.
At the time this was one of the largest attacks seen on the ISP’s network. Attacking IPs
numbered in the thousands.
Page 43The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
Mitigation Steps:
1. The attack was identified along with a target IP by the customer’s DoS detection service.
2. The customer engaged the DoS mitigation service, the traffic was re-routed to the DoS
mitigation centers. The attack traffic was dropped and legitimate traffic delivered.
With larger attacks (10s to 100s of Gbps), there is a risk of collateral impact to customers not
targeted by the attack. Collateral damage can often be avoided if the attack is detected and
mitigated quickly.
Reco
Recommended Practices:
1. Blackhole routing should be configured on ISP routers in case a customer is attacked that
does not subscribe to any DoS mitigation service.
2. Network instrumentation and alarming based on SNMP polling, netflow, probes, or a similar
technology is critical to detecting bandwidth saturation problems quickly (15 minutes or
less).
3. Netflow collection or some similar technology should be deployed to identify attack targets
and target protocols.
4. Providers offering attack mitigation/scrubbing services should engineer the infrastructure
Page 44The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
such that attack traffic isn’t concentrated in a single area or scrubbing center. Capacity to
those centers should be sized appropriately.
B. Attack Directed at ISP and Customer Infrastructure IPs
Background: This attack again used UDP/80 packets (garbage traffic) in high volume to
exhaust the target’s bandwidth. However, in this case the attack was directed first at the
customer’s router interface IP and then at the ISP’s.
Mitigation Steps:
1. The attack was identified along with a target IP via netflow.
2. The /30 subnet between the ISP and the customer was blackholed.
3. Filters were subsequently applied on ISP border routers to limit traffic destined for ISP
infrastructure.
Recommended Practices:
• Limit traffic to ISP point-to-point infrastructure as much as practical, whether by filtering or
routing.
• Do not use point-to-point infrastructure IPs for NAT, termination of tunnels, or other traffic
that requires IPs to be advertised and routed when they would otherwise not need to be.
• Implement detection as suggested in Case Study 1 so these attacks can be identified quickly.
Note that when an ISP address is the target of the attack, the customer will never see the
traffic.
Potential Challenges:
• Filtering at every ISP ingress point may be impractical.
• Re-addressing a network to space that is not routed may be a difficult, time-consuming task.
C. Collateral Damage from DNS Reflection Attack
Background: This attack again used spoofed UDP/53 packets (DNS queries) in high volume
towards unfiltered recursive DNS servers to magnify the attack and exhaust the target’s
bandwidth. In this case, the ISP was at risk for adverse impact even though the attack wasn’t
directed at the ISP at all.
Mitigation Steps:
1. The attack was identified along with a target IP via netflow as well as logging configured on
the DNS server.
2. Queries from customers were routed through a DoS mitigation service.
Page 45The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
3. ISP later followed up to get customer equipment properly filtered.
Recommended Practices:
• Configure attack mitigation services for critical infrastructure like DNS services. Examples
of mitigation include traffic scrubbing and service rate-limiting.
• Expand mitigation capacity as needed for infrastructure services.
• Distribute critical services using technologies like anycast or content distribution networks
when possible.
• Provision out-of-band management for critical infrastructure such that an attack does not
impede access to equipment needed to mitigate the attack.
• Limit the exposure of services to only those that need access to them (eg DNS, NTP, etc).
• Avoid use of equipment configured with unprotected services such as unfiltered DNS and
known SNMP community strings.
• Apply anti-spoofing controls where practical and possible, for example residential networks
and hosting centers.
Potential Challenges:
• Provisioning mitigation capacity can be an “arms race” with attackers.
• Some services cannot be effectively filtered without unacceptable collateral impact.
• Anti-spoofing (BCP 38) is not possible for many transit customers.
D. Home Gateway/Router Originated DDoS
• Background: A particular home gateway vendor had a bug that causes it to flood DNS
requests at line rate when the modem in front of it reboots. The ISP increased broadband
speeds in their largest market, requiring modem reboots. Approximately 250 home
gateways began flooding DNS requests, taking down the ISP’s DNS cluster
•
• Problems Discovered:
• No DDOS mitigation capability that deep into the ISP’s network. Data scrubbing centers sit
at the peering edge of the ISP’s network.
Page 46The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
• DNS servers were returning additional, optional authority information with each reply,
causing an amplification effect
• Rate limiting features were not used at the ISP’s load balancers
• ISP had difficulty managing the DNS servers through the query interfaces, which were
saturated due to the broadband modem DNS flooding.
• Mitigation Steps:
1. Used out of band security tools that capture DNS packets. Configured the tools to count the
number of packets seen over a given time period and generate alerts on customers exceeding
those thresholds.
2. Fed the alerts into the existing abuse management system and took the customers offline
3. Automated the process for future use
Recommendations:
• For any given service, make sure it returns as little information as possible so it can't be
readily used as an amplifier.
• Ensure servers remain reachable when under attack by separating management interfaces
from service interfaces.
• Employ the security features (such as rate limiting) available in existing networking
hardware.
• Mitigation can be accomplished out of line using passive monitors that signal other tools to
take some action.
E. Null Routing
Background: Null routing is the simplest form of DDOS mitigation, but also the one with the
most collateral damage. It's a hammer dropping all traffic destined for a given IP address.
Pros:
• Simple and quick to implement
• Drops traffic at the peering edge of the network on the largest links
Cons:
• Drops all traffic to a given IP and not just the malicious traffic
Use cases:
• Residential (or other dynamic IP) customer under attack. The ISP can simply drop all traffic
destined for the target IP and give the customer a new one
• Outbound attack. If an IP address at another ISP is under attack, and that ISP indicates
there's no legitimate need for our customers to reach it, the first ISP can drop the packets
before they leave its network. Example: another ISP's router is under attack. The first ISP’s
customers have no reason to send packets directly to that router, so they null route its ip on
our network.
IV. ISP Mitigation Techniques (Tools/Technical Controls)
There are two primary phases to responding to DDoS attacks:
Page 47The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
Phase 1: Detection
DDoS attacks can be detected by ISPs using either volumetric or application based methods.
For example, in the case of volumetric based solutions ISPs would establish baseline against
which attack traffic anomalies can be determined. Another means to detect attacks is directly
from customers who also often observe gradual increases in ingress traffic volumes on their
own, and will contact ISPs accordingly.
Detection:
Type North-to-South South-to-North East-to-West
• Netflow-based • Netflow-based • Call from victim
solutions solutions
Volumetric • Utilization • Call from victim
monitoring
• Call from victim
• DPI-based • DPI-based solutions • Call from victim
solutions • Host-based solutions
Application28 • Host-based • Call from victim
solutions
• Call from victim
Phase 2: Mitigation
The mitigation phase of DDOS response activity has the goal of countering the effects of the
malicious action. Mitigation typically takes the form of either (1) filtering bad traffic, or (2)
reducing the intensity of the attack by degrading the botnet source. This second action can be
done in variety of ways such as contacting the owners of infected PCs and servers before,
during, and after an attack. Thus, the primary goal of ISPs DDoS security activities involves all
possible attempts to successfully block, divert, filter, and slow down attack traffic embedded in
the normal stream of ingress traffic aimed at a victim site. Since most DDOS attacks vary widely
(in contrast to the recent banking attacks, which followed a more routine cadence), the decision
process can be highly dynamic, and is usually dependent on real-time analysis.
Mitigation:
Generally speaking, the simplest mitigation technique that will solve the problem is often
preferred. From a service perspective, however, more specific mitigation techniques are
preferred over those that are more blunt and have greater impact on legitimate traffic. As noted
previously, the appropriate action in a given situation does depend on the specifics of the attack
and the target.
Blackhole routes are the preferred mitigation in the case that the service or customer under
28 Application layer DDoS attacks can be more difficult to detect and in some instances may
require more intrusive tools than traditional volumetric based tools such as the use of Deep
Packet Inspection (DPI) and can also be complicated by the use of SSL or other based
encryption.
Page 48The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
attack will not suffer any degradation or outage by losing all traffic to the target. For example,
in the case that the target address never needs to receive any traffic from the Internet, a
blackhole route of that IP is the simplest answer. Additionally, an outbound attack could also be
mitigated by blackhole routing the attack target. If services are required of the target address,
but the attack is using a different protocol or service, then a packet filter like a router ACL may
be effective. Non-trivial volumetric attacks – those targeted at needed services – often require
more specialized scrubbing services or DPI solutions. These services are designed to allow most
legitimate traffic to pass while blocking most attack traffic.
Type North-to-South South-to-North East-to-West
• Scrubbing • Suspend attacker’s • Suspend
center/offramp service attacker’s
• blackhole route • Other device control, service
• router ACL such as blocking • Other device
Volumetric • BGP Flowspec ports on a modem control, such as
• blackhole route blocking ports
• router ACL on a modem
• blackhole route
• router ACL
• Scrubbing • DPI-based solutions • Suspend attacker’s
center/offramp • Host-based solutions service
• DPI-based • Suspend attacker’s • Other device
Application solutions service control, such as
• Host-based • Other device control, blocking ports on a
solutions such as blocking modem
ports on a modem • Host-based solutions
V. Additional Recommendations
• ISPs review the ABCs for ISPs set of recommendations for malware mitigation published by
CSRIC III in 2012 given that many DDoS attacks have emanated from infected end users.
• Similar best practices be developed for Hosting Providers in terms of abuse desk and
notification processes to alert infected tenants of hosting centers given data center based
attacks.
• ISPs review BCP 38 and other alternatives to potentially manage IP address spoofing.
Page 49The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
Financial Subgroup Case Study
Case Study:
From late 2012 into mid 2013, US Financial Institutions (USFIs) experienced ongoing
Distributed Denial of Service (DDoS) attacks against their networks. Analysis indicates that
some of the attacks originate from a nation state threat actor. These attacks show evidence of
preplanning and continue to evolve in complexity.
It is believed that the DDoS attacks on the USFIs were part of a larger attack strategy and
portend more serious attacks. The USFIs targeted represent a significant component of US
economic activity, are emblematic of US economic stability and if compromised could pose a
systemic risk to the financial sector. The groups claiming credit have threatened more attacks.
What is a DDOS Attack?
A DDoS attack is a coordinated cyber-attack with the intent to disrupt the availability of an
information processing system(s) or application(s) by consuming network bandwidth or by
overwhelming the target system with simultaneous data connections from multiple autonomous
sources. The distributed model has given rise to botnets, which are collections of malware-
infected hosts that have the capability of launching DDoS attacks at the will of the adversary
who controls them to significantly change the velocity of attacks.
DDoS Types Used:
• UDP Flooding
• TCP Flooding
• Search function attacks
• Large file GET
• Infrastructure-level attacks
• Authentication portal attacks
Steps in attack:
• Port 80 SYN Flood with some UDP to overwhelm network bandwidth if possible.
• Attack DNS Servers with malformed UDP/TCP packets.
• Attack DNS ports on web servers.
• Attack SSL Connections.
• URLs (latest tactic) switch from main site to secondary sites.
• HTTP/HTTPS Post attacks (Search functions).
• Ports 80/443/53
Tools:
• The attackers use customized attack scripts sending traffic to Ports 80, 443, 53, 1800
Adaptive Techniques:
• Significant volume (Bandwidth/Packets) constant morphing (Port/Protocol).
Page 50The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
• On the fly customization of attacks to address mitigation.
• Ability to compromise and then utilize malware-infected servers with high bandwidth
connections.
• Ability to add to bots and add new clients to evade IP filters/blacklists.
While the attacks in 2012/13 centered mostly on bandwidth attacks (Layer 3 & 4); the threat
actors shifted and evolved their capabilities to conducting more complicated Layer 7 attacks.
Using SSL, threat actors engineered attacks so the attacking traffic would seem like legitimate
traffic in an attempt to camouflage their nefarious activities and fool network defenses. Further,
attacks evolved from single targets, with attackers “dwelling” on a target for hours or days, to
attacks against multiple USFIs concurrently or in rapid succession.
Technical Controls:
1. Carrier protocol rate limiting
2. Carrier source IP blocking
3. Carrier blackhole filtering of the destination IP address or protocol
4. Load balancers filtering using custom scripts
5. On-premise web application firewalls
6. Third party BGP-based data scrubbing
7. Third party DNS-based data scrubbing
8. IPS rules
9. Network blocks based on layer 3 or 4 characteristics
10. On-premise DDoS detection/mitigation equipment
11. Carrier blocking based on source IP geography
13. Connection rate limiting
15. On-premise packet/session Time-to-Live (TTL) filtering
16. On-premise protocol/Port filtering
Emerging Trends
• The botnet architecture is becoming more sophisticated and difficult to trace and C2
(Command and Control) systems are increasingly tiered using proxy servers to obfuscate
the location of the system that is executing the commands.
• Devices are increasingly spread out globally making the coordination of shutting down
these systems difficult due to the fact that countries often have different and sometimes
conflicting laws.
• Botnets are becoming extremely sophisticated, and some have the ability to wipe a
compromised system’s entire hard drive after it has completed an attack.
• DDoS tools are/will continue to become more sophisticated, with multi-tasking and
multithreading capabilities that will provide the potential to launch attacks on multiple
targets and services simultaneously.
• Social media such as Twitter could potentially be used to redirect and configure zombies
as new attack vectors.
• With the proliferation of mobile devices, adversaries will compromise and install botnets
and leverage them to conduct DDoS attacks.
Page 51The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
• Attackers have developed the ability to actively monitor defensive actions and
continuously adapt their attacks to attempt to defeat mitigation. Attackers have
demonstrated the capability to add to the bots, adding new clients to evade IP
filters/blacklists.
Page 52The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
Internet Security Experts Subgroup Case Studies
Case Study #1: Outbound/crossbound DDoS attack launched by servers in an Internet Data
Center (IDC)
Servers compromised in an IDC due to vulnerable versions of software; no root, no spoofed
traffic.
• Multiple, shifting attack vectors – HTTP, HTTP/S, malformed DNS query floods; GETs
via HTTP & HTTP/S consuming outbound transit bandwidth on target networks.
Collateral impact to legitimate server users, IDC operators, transit Network Operators.
• High packets per second (pps) / bits per second (bps) per source
Case Study #2: DNS reflection/amplification attack leveraging open DNS recursors.
The attacker spoofs the IP address of the target of the attack, sending DNS queries for pre-
identified large DNS records (ANY records, large TXT records, etc.) either to abusable open
DNS recursive servers, or directly to authoritative DNS servers.
The attacker chooses the UDP port which he’d like to target – with DNS, this is typically limited
to either UDP/53 or UDP/1024-65535. The destination port is UDP/53
The servers ‘reply’ either directly to the attack target or to the intermediate open DNS recursive
servers with large DNS responses – the attack target will see streams of unsolicited DNS
responses broken down into initial and non-initial fragments.
Response sizes are typically 4096 – 8192 bytes (can be smaller or larger), broken down into
multiple fragments.
Packet sizes received by the attack target are generally ~1500 bytes due to prevalent Ethernet
MTUs – and there are lots of them.
As these multiple streams of fragmented DNS responses converge, the attack volume can be
huge – the largest verified attack of this type so far is ~200gb/sec. 100gb/sec attacks are
commonplace.
Internet transit bandwidth of the target, along with core bandwidth of the target’s
peers/upstreams, as well as the core bandwidth of intermediary networks between the various
DNS services being abused and the target, are saturated.
In most attacks involving intermediate open DNS recursive servers are reflectors, between
~20,000 – 30,000 abusable recursive DNS are leveraged by attackers. Up to 50,000 abusable
open recursive DNS servers have been observed in some attacks.
Page 53The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
In attacks leveraging authoritative DNS servers directly, hundreds or thousands of these servers
are utilized by attackers.
Many well-known authoritative DNS servers are anycasted, with multiple instances deployed
around the Internet.
Page 54The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
Page 55The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
Case Study #3: Endpoint enterprise network Web server targeted by ntp reflection/amplification
attack.
The attacker spoofs the IP address of the target of the attack, sends monlist, showpeers, or other
NTP level-6/-7 administrative queries to multiple abusable NTP services running on servers,
routers, home CPE devices, etc.
The attacker chooses the UDP port which he’d like to target – typically, UDP/80 or UDP/123,
but it can be any port of the attacker’s choice – and uses that as the source port. The destination
port is UDP/123.
The NTP services ‘reply’ to the attack target with non-spoofed streams of ~468-byte packets
sourced from UDP/123 to the target; the destination port is the source port the attacker chose
when generating the NTP monlist/showpeers/etc. queries.
As these multiple streams of non-spoofed NTP replies converge, the attack volume can be huge
– the largest verified attack of this type so far is over 400gb/sec. 100gb/sec attacks are
commonplace.
Due to sheer attack volume, the Internet transit bandwidth of the target, along with core
bandwidth of the target’s peers/upstreams, as well as the core bandwidth of intermediary
networks between the various NTP services being abused and the target, is saturated with non-
spoofed attack traffic.
Page 56The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
In most attacks, between ~4,000 - ~7,000 abusable NTP services are leveraged by attackers. Up
to 50,000 NTP services have been observed in some attacks.
Servers, services, applications, Internet access, et. al. on the target network overwhelmed and
rendered unavailable by sheer traffic volume – tens or hundreds of gb/sec frequent.
Complete saturation of peering links/transit links of the target network.
Total or near-total saturation of peering links/transit links/core links of intermediate networks
between the NTP reflectors/amplifiers and the target network – including the networks of direct
peers/transit providers of the target network
Widespread collateral damage – packet loss, delays, high latency for Internet traffic of
uninvolved parties which simply happens to traverse networks saturated by these attacks.
Unavailability of servers/services/applications, Internet access for bystanders topologically
proximate to the target network.
Page 57The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
Page 58The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
Page 59The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
Page 60The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
Appendix E: Best Practices
Introduction to Best Practices
Best Practices are statements that describe the industry’s guidance to itself for the best
approach to addressing a concern. They result from unparalleled industry cooperation that
engages vast expertise and considerable resources. The primary objective of Best Practices
is to provide guidance from assembled industry expertise and experience. The
implementation of Best Practices is intended to be voluntary. Decisions of whether or not
to implement a specific Best Practice are intended to be left with the responsible
organization (e.g., Service Provider, Network Operator, or Equipment Supplier). In
addition, the applicability of each Best Practice for a given circumstance depends on many
factors that need to be evaluated by individuals with appropriate experience and expertise
in the same area addressed by the Best Practice.
The Best Practices recommended by CSRIC IV Working Group 5 are intended to give
guidance. Decisions of whether or not to implement a specific Best Practice are intended
to be left with the responsible organization (e.g., Service Provider, Network Operator, or
Equipment Supplier). Mandated implementation of these Best Practices is not consistent
with their intent. The appropriate application of these Best Practices can only be done by
individuals with sufficient knowledge of company specific network infrastructure
architecture to understand their implications. Although the Best Practices are written to be
easily understood, their meaning is often not apparent to those lacking this prerequisite
knowledge and experience. Appropriate application requires understanding of the Best
Practice impact on systems, processes, organizations, networks, subscribers, business
operations, complex cost issues, and other considerations. With these important
considerations regarding intended use, the industry stakeholders are concerned that
government authorities may inappropriately impose these as regulations or court orders.
Because these Best Practices have been developed as a result of broad industry
cooperation that engages vast expertise and considerable voluntary resources, such
misuse of these Best Practices may jeopardize the industry’s willingness to work together
29
to provide such guidance in the future.
29
These principles were brought forward from the work of the NRIC VII Focus Group 3B, Public Data Network
Reliability Final Report, Sections 2.3.2 and 3.4.2.
Page 61The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
WG5 has identified the following Categories for Best Practices to mitigate server-based
DPrDeopSa artattaicokns :
Identification
Classification
Traceback
Reaction
Post Mortem & Recovery
The following Best Practices address server-based DDoS attacks.
Page 62The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
Network Operators
Preparation
BP Number: New BP2
Destination Based Black Hole Filtering / Remote Triggered Destination based Black
Hole Filtering:
Network Operators should deploy destination based Black Hole Filtering (BHF) in order to
protect their networks fro m DDoS attacks. Network Operators should, where feasible,
pBrPo Rviedfee rcuenstcoem/Cero minimtiaetnetds :R emotely Triggered Destination Black Hole Filtering (RTBHF)
for a customer’s IP space.
RFC 4778 is useful as an initial response in order to control the attack while verify it
impact and reconfiguring the network.
Note that once Black Hole filtering is in place, it completes the DDoS attack by dropping all
traffic to the destination. Traffic to the target can be resumed by assigning new IP
addresses to the target and advertising the new DNS records..
Phase: Preparation (Deploy Mitigation Tools, Network Operator, Hosting Filtering)
Implementation Guidance: Effectiveness (H/M/L): H
Implementation Difficulty: (H/M/L): M
BP Number: New BP8
Deploy Anti-Spoofing Technologies:
NBPet Rweofrekr Oenpceera/tCoorms amnden Htos:s ting Providers should, where feasible, deploy anti-spoofing
technologies to prevent spoofed traffic from originating from their networks.
Related to BP 9-7-0408
Note that deployment may not be feasible on some multi-homed networks because of the
need for asymmetrical routing.
Phase: Preparation (Protect, Network Operator, Hosting Providers)
Implementation Guidance: Effectiveness (H/M/L):
Single Home Networks: H
Multi-Homed Networks: M to L
Implementation Difficulty: (H/M/L):
Single Home Networks: L
Multi-Homed Networks: H
BP Number: New BP16
Deploy Network Data Scrubbing:
Network Operators should employ, where feasible, network data scrubbing centers to
filter DDoS attack traffic. This can be accomplished by “offramping” suspected attack DDoS
traffic to a network scrubbing center where attack traffic can be filtered and “onramping”
legitimate traffic back to the target.
Page 63The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
BP Reference/Comments:
It is important to size the capacity of the network and scrubbing centers to accommodate
attack traffic so as to minimize potential collateral damage caused by large surges in traffic.
Phase: Preparation (Deploy Mitigation Tools, Network Operator)
Implementation Guidance: Effectiveness (H/M/L): H
Implementation Difficulty: (H/M/L): H
BP Number: 9-8-8047
Protect Against DNS (Domain Name System) Denial of Service Attacks:
Network Operators should provide DNS DoS protection by providing defense in depth to
preve nt attacks that would make DNS unavailable by implementing protection techniques
such as:
1) Increase DNS resiliency through redundancy and robust network connections, e.g.,
deploy multiple servers with diverse network connectivity for each service such
that any one server or site does not affect others. Deploy anycast to improve the
redundancy of their DNS servers. Anycast can be used to provide DNS service from
a single DNS IP address utilizing multiple DNS servers in the network hence
improving DNS resiliency. Note that Anycast address network redundancy and
does not provide load balancing among DNS nodes.
2) Have separate name servers for internal and external traffic as well as critical
infrastructure, such as OAM&P and signaling/control networks,
3) Where feasible, separate caching or recursive DNS servers from authoritative DNS
servers,
4) Protect DNS information by protecting master name servers with appropriately
configured firewall/filtering rules, implement secondary masters for all name
resolution, and using access control lists to limit zone transfer requests to
authorized parties.
5) Configure network instrumentation to alert providers' operations teams to
anomalous traffic volumes.
6) Design DNS network filtering into DNS architectures to allow network and
application level filtering of specific DNS traffic (domains, query types, source IPs,
query rates, etc.) during an attack; this must be configured in advance. This
configuration should minimize interference with legitimate DNS traffic.
7) Have out-of-band management connectivity for DNS servers so the servers can be
managed during an attack.
8) Separate caching DNS servers from authoritative servers.
9) Do not use Internet-facing DNS servers for internal network operations,
administration, maintenance and provisioning systems.
BP R10e)fPerroevnicdee/ rCoobmusmt eDnNtSs :s erver and bandwidth capacity in excess of maximum network
connection traffic
RFC-2870, ISO/IEC 15408, ISO 17799, US-CERT "Securing an Internet Name Server"
(http://www.cert.org/archive/pdf/dns.pdf).
Phase: Preparation (Capacity and Resources, Network Operator)
Implementation Guidance: Effectiveness (H/M/L): H
Implementation Difficulty: (H/M/L): H
Page 64The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
BP Number: 9-8-8753A – New BP (Formerly BP 9-8-8563)
Vulnerability Management - Notification:
Updated to:
When a DoS or DDoS vulnerability or exploit is discovered, Network Operators, Hosting
Providers, and hardware/software vendors should notify owners/operators of the affected
systems of the issue to ensure software, configurations, or equipment is updated to
remediate the vulnerability. If short term remediation is not possible, owners/operators
sBhPo Ruledf ecroennsicdee/rC soymstmeme notrs n: etwork mitigations to minimize the likelihood of DDoS attack
exploitation.
Sans Institute, "Vulnerability Management: Tools, Challenges and Best Practices." 2003. Pg.
12 - 13.
Preparation (Protect) BP
Phase: Preparation (Protect, Network Operator, Hosting Providers)
Implementation Guidance: Effectiveness (H/M/L): H
Implementation Difficulty: (H/M/L): H
BP Number: 9-9-8068
Service Providers, Network Operators, Hosting Providers, Public Safety, and Equipment
Suppliers should develop and practice a communications plan as part of the broader
Incident response plan identifying key players to include as many of the following items as
appropriate: contact names, business telephone numbers, home telephone numbers, pager
numbers, fax numbers, cell phone numbers, home addresses, internet addresses,
permanent bridge numbers, etc. Notification plans should be developed prior to an
event/incident happening where necessary. The plan should also include alternate
communications channels (e.g., alpha pagers, internet, satellite phones, VOIP, private lines,
sBmPa Rret fpehroennecse)/ bCaolamnmcinegn ttsh:e value of any alternate method against the security and
information loss risks introduced.
Alternate broadband communication path for coordination and management.
Phase: Preparation (Communication, Network Operator, Hosting Provider)
I mplementation Guidance: Effectiveness (H/M/L): H
Implementation Difficulty: (H/M/L): L
BP Number: 9-8-8753
Vulnerability Management:
Updated to:
Network Operators, Hosting Providers, and hardware/software vendors should ensure
they can manage security vulnerabilities in products they manage or maintain for
customers. Such management may be passive, such as simply maintaining a list of
customers to whom they have distributed the product, or active, such as vulnerability
scanning and reporting. Also, products, services, hardware and software should be tested
for vulnerabilities prior to significant deployments.
Page 65The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
BP Reference/Comments:
Sans Institute, "Vulnerability Management: Tools, Challenges and Best Practices." 2003. Pg.
12 - 13.
Preparation (Protect) BP
Phase: Preparation (Protect, Network Operator, Hosting Providers)
Implementation Guidance: Effectiveness (H/M/L): H
Implementation Difficulty: (H/M/L): H
BP Number: 9-8-8912
Communicate Implementation of Situational Awareness and Protective Measures
with Other Network Operators:
Network Operators should make reasonable efforts to communicate with other operators
and security software providers, by sending and/or receiving abuse reports via manual or
automated methods. This is especially important in the case of DDoS attacks to notify
sources of DDoS traffic of their involvement in the attack. This information sharing and
collaboration is needed to help prevent future attacks. These efforts may include
information such as implementation of "protective measures" such as reporting abuse
(e.g., spam) via feedback loops (FBLs) using standard message formats such as Abuse
Reporting Format (ARF). Where feasible, Network Operators should engage in efforts with
other industry participants and other members of the internet ecosystem toward the goal
oBfP i mRepfleemreennctein/gC ommorme ernobtsu:s t, standardized information sharing in the area of botnet
detection between private sector providers.
Note that creating communication mechanisms with other Network Operators should take
place ahead of an attack so that communication channels are available during an attack if
needed.
See the following document for more information:
http://www.maawg.org/sites/maawg/files/news/CodeofConduct.pdf
Vulnerabilities can be reported in a standardized fashion using information provided at
http://nvd.nist.gov/
http://puck.nether.net/mailman/li stinfo/nsp-security
https://ops-trust.net/
https://www2.icsalabs.com/veris/
https://stix.mitre.org/
Phase: Preparation (Communication, Network Operator)
Post Mortem & Recovery
Implementation Guidance: Effectiveness (H/M/L): M
Implementation Difficulty: (H/M/L): M
Note that the Best Practices in this grouping are primarily aimed at ISPs that provide
service to consumer end-users on residential broadband networks, but may be applicable
to other users and networks as well.
Page 66The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
BP Number: 9-8-8917
Notification to End Users:
Network Operators and Hosting Providers should develop and maintain critical
notification methods to communicate with their customers that their computer, servers,
and/or network has likely been infected with malware. This should include a range of
options in order to accommodate a diverse group of customers and network technologies.
Once a Network Operator has detected a likely end user security problem, steps should be
undertaken to inform the Internet user that they may have a security problem. A Network
Operator or Hosting Provider should decide the most appropriate method or methods for
providing notification to their customers or internet users, and should use additional
methods if the chosen method is not effective. The range of notification options may vary
by the severity and/or criticality of the problem.
Examples of different notification methods may include but are not limited to: email,
tBePle Rpehfoenree cnaclel,/ pCoosmtaml meanitls, :i nstant messaging (IM), short messaging service (SMS), and
web browser notification.
A Network Operator and Hosting Provider decision on the most appropriate method or
methods for providing notification to one or more of their customers or Internet users
depends upon a range of factors, from the technical capabilities of the Network Operator,
to the technical attributes of the Network Operator's network, cost considerations,
available server resources, available organizational resources, the number of likely
infected hosts detected at any given time, and the severity of any possible threats, among
many other factors. The use of multiple simultaneous notification methods is reasonable
for an Network Operator but may be difficult for a fake anti-virus purveyor. Note that the
use of blind Notifications, i.e., Notifications without follow-up, have been found to be less
effective than methods that verify or require user action. Best Practice 9-8-8921 provides
information on how to address the malware infection. https://otalliance.org/best-
practices/industry-best-practices
More information can be found at:
https://otalliance.org/system/files/files/resource/documents/ota_botnet_notification_wh
itepaper2012.pdf
Phase: Preparation (Communication, Network Operator, Hosting Provider)
Implementation Guidance: Effectiveness (H/M/L): L
Implementation Difficulty: (H/M/L): M
Note that the Best Practices in this grouping are primarily aimed at ISPs that provide
services to consumer end-users on residential broadband networks, but may be applicable
to other users and networks as well.
BP Number: 8-9-8074
Updated
Denial of Service (DoS) Attack - Target:
Where feasible, Network Operators, Hosting Providers, and Target networks and
Equipment Supplier equipment should be able to survive significant increases in both
packet count and bandwidth utilization. Where feasible, Equipment and Software
Suppliers should develop effective DoS/DDoS survivability features for their product lines.
Page 67The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
Infrastructure supporting mission critical services should be designed for significant
increases in traffic volume and must include network devices capable of filtering and/or
rate limiting traffic. Network engineers must understand the capabilities of the devices and
how to employ them to maximum effect. Wherever practical, mission critical systems
should be deployed in clustered configuration allowing for load balancing of excess traffic
aBnPd R perfoetreecntecde /bCyo am pmurepnotsse: built DoS/DDoS protection device. Operators of critical
infrastructure should deploy DoS survivable hardware and software whenever possible.
Note: This Best Practice could impact 9-1-1 operations.
e.g., SYN Flood attack defense, CERT/CC ® Advisory CA-1996-21 TCP SYN Flooding and IP
Spoofing Attacks - http://www.cert.org/advisories/CA-1996-21.html. Related to NRIC BP
8753A.
Note that, Network Operators, Hosting Providers, Targets, and Equipment Suppliers need
to determine which services are mission critical in the implementation of this Best
Practice.
Phase: Preparation (Capacity and Resources, Network Operator, Hosting Provider, Target)
Implementation Guidance: Effectiveness (H/M/L): M
Implementation Difficulty: (H/M/L): H
BP Number: 9-9-8725
Signaling DoS Protection:
Updated to:
Network Operators should establish alarming thresholds for various traffic indicators to
ensure that DoS/DDoS conditions are recognized. Examples include comparison of
baselines of normal traffic levels at key network points to current traffic levels, and
cBoPm Rpeafreirsoenn coef /bCaosmelimnee noft sn:e tflow information for both traffic levels and protocols to
current traffic levels.
Note: This Best practice could impact 9-1-1 operations.
Alarming thresholds are intended to recognize DoS conditions that may be a threat to the
operator infrastructure.
Phase: Preparation (Monitoring & Visibility, Network Operator)
Implementation Guidance: Effectiveness (H/M/L): H
Implementation Difficulty: (H/M/L): M
BP Number: New BP3
Sinkhole Routing:
NBPet Rweofrekr Oenpceera/tCoorms smhoeunltds :d eploy Sinkhole Routing in order to route attack traffic to other
parts of the network for analysis (sinkholing) and dropping (offramping).
Phase: Preparation (Deploy Mitigation Tools, Network Operator, Ho sting Filtering)
Implementation Guidance: Effectiveness (H/M/L): M
Implementation Difficulty: (H/M/L): H
RFC 4778 can be used along with Anycast to provide redundancy.
Page 68The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
BP Number: New BP4
Source based Black Hole Filtering:
Network Operators should deploy Source Based Black Hole Filtering (SBBHF)or similar
dynamic mechanisms that trigger network-wide filtering based on source packet header
information in order to protect their networks from DDoS attacks. Note that this may not
bBeP a Rse effefercetnivcee /ifC loamrgme neunmtsb: er or source IP addresses are used in the attack, e.g., botnet
attack, or the attack traffic uses spoofed IP addresses for obfuscation.
Greene, Barry Raveendran. “Phase 1 – Prepare the Tools and Techniques, Using IP Routing
as a Security Tool.” ISP Security Bootcamp Singapore 2003. 31 July 2003 ftp://ftp-
eng.cisco.com/cons/isp/security/ISP-Security-Bootcamp-Singapore-2003/H-Preparation-
Tools-v3-0.pdf
Phase: Preparation (Deploy Mitigation Tools, Network Operator, Hosting Filtering)
Implementation Guidance: Effectiveness (H/M/L): M
Implementation Difficulty: (H/M/L): M
BP Number: New BP5
Deploy Automatic Distribution of Traffic Filters:
Network Operators should deploy systems, such as BGP Flowspec, that automatically
distribute traffic filters to relevant devices in the event of a DOS/DDoS attack. These
sByPs tReemfes rceannc ael/loCwo matmtaeckn ttsra: ffic to a target to be filtered (scrubbed) while allowing
legitimate traffic through.
RFC 5575, RFC 4360
Phase: Preparation (Deploy Mitigation Tools, Network Operator, Hosting Filtering)
Implementation Guidance: Effectiveness (H/M/L): H
Implementation Difficulty: (H/M/L): H
Note that currently not all router vendors support this technology.
BP Number: New BP9
Prioritization of traffic to ensure critical traffic, e.g., control plane, not affected by
server-based DDOS attack:
NBPet Rweofrekr Oenpceera/tCoorms smhoeunltds :p rioritize control plane and other critical traffic over transit
traffic to ensure that DDoS attack traffic does not impact routing protocol operation.
Phase: Preparation (Capacity and Resources, Network Operator)
Implementation Guidance: Effectiveness (H/M/L): H
Implementation Difficulty: (H/M/L): M
BP Number: New BP14
Prevent DNS Services From Being Used in Reflective Attacks:
Network Operators should apply protectioPnasg teo 6 p9revent their DNS services from beingThe Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
used as part of a reflective attack if practical. These protections may include, but are not
limited to:
1. Limit recursive DNS servers to only respond to queries from the smallest
practical set of IP subnets required for the service.
2. Implement instrumentation and alarming processes to detect domains, IPs,
and servers being abused in an attack.
3. Configure controls to allow mitigation of specific attacks such as query rate
limits, removal of specific domains, or filtering of query types that can be
applied when an attack is detected.
4. Have traffic anomaly detection and response capability.
5. Deploy DNS protocol validation systems, where appropriate, to drop
BP Referencei/llCeogmitimmaetnet so:r malicious DNS traffic.
This BP Replaces BP 9-8-8118
Note that since the number of DNS servers under the control of the Network Operator is
low compared with the total number of DNS servers deployed, the impact of implementing
this Best Practice only by Network Operators on the overall problem of open DNS servers
being used in reflective attacks is low.
Phase: Preparation (Protect, Network Operator, Capacity and Resources, Network
Operator)
Implementation Guidance: Effectiveness (H/M/L): L
ImplemenItdaetinotni fDiicfafictuioltny: (H/M/L): M
BP Number: 9-8-8916
Bot Detection and the Corresponding Notification Should Be Timely:
Updated to:
Network Operators and Hosting Providers should ensure that bot detection and the
corresponding notification to hosting customers are timely, since such security problems
are time-sensitive. If complex analysis is required and multiple confirmations are needed
to confirm a bot is indeed present, then it is possible that the malware may cause some
damage, to either the infected host or remotely targeted system (beyond the damage of the
initial infection) before it can be stopped. Thus, a Network Operator or Hosting Provider
must balance a desire to definitively confirm a malware infection, which may take an
extended period of time, with the ability to predict the strong likelihood of a malware
infection in a very short period of time. This 'definitive-vs.-likely' challenge is difficult and,
when in doubt, Network Operators and Hosting Providers should error on the side of
cBaPu tRioenfe brye ncocem/mCoumnimcaetinntgs :a likely malware infection while taking reasonable steps to
avoid false positive notifications.
The Network Operator notification implementation needs to balance the certainty of a
detected infection with the uncertainty of a transient detection of malicious traffic to
minimize the possibility of false-positive notifications which could become an annoyance
to customers and become unmanageable by the Netw ork Operator.
Page 70The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
More information can be found at U.S. Anti-Bot Code of Conduct (ABCs) for Internet Service
Providers (ISPs):
http://transition.fcc.gov/bureaus/pshs/advisory/csric3/CSRIC-III-WG7-Final-Report.pdf
Phase: Identification (Monitoring & Visibility, Network Operator, Hosting Provider)
Implementation Guidance: Effectiveness (H/M/L): L (notification only)
Implementation Difficulty: (H/M/L): M
Note that the Best Practices in this grouping are primarily aimed at ISPs that provide
service to consumer end-users on residential broadband networks, but may be applicable
to other users and networks as well.
BP Number: New BP6
Use Netflow Data analysis to Analyze DDoS Attacks:
Where feasible, Network Operators and Hosting Providers, should enable, collect, and
analyze Netflow data to aid in the identification and classification of DDoS attacks. Data
sBhPo Ruledf ebree anvcaeil/aCbolem amfteern tths:e attack to allow further analysis. Netflow data should be
retained consistent with the Network Operator’s data retention policy.
Netflow data may be useful in identifying spoofing attacks.
Phase: Identification (Monitoring and Visibility, Network Operator, Hosting Providers)
I mplementation Guidance: Effectiveness (H/M/L): H
Implementation Difficulty: (H/M/L): M
BP Number: 9-8-8913
Maintain Methods to Detect Bot/Malware Infection:
Network Operators should maintain methods to detect likely malware infection of
customer equipment. Detection methods can vary widely due to a range of factors.
Detection methods, tools, and processes may include but are not limited to: external
feedback, observation of network conditions and traffic such as bandwidth and/or traffic
pBaPt tReernfe arneanlcyes/isC, osimgnmateunrtess:, behavior techniques, and forensic monitoring of customers on
a more detailed level.
More information can be found at:
http://teamcymru.org
http://shadowserver.org
http://abuse.ch
http://cbl.abuseat.org
U.S. Anti-Bot Code of Conduct (ABCs) for Internet Service Providers (ISPs):
http://transition.fcc.gov/bureaus/pshs/advisory/csric3/CSRIC-III-WG7-Final-Report.pdf
Note that the Best Practices in this grouping are primarily aimed at ISPs that provide
service to consumer end-users on residential broadband networks, but may be applicable
to other users and networks as well.
Phase: Identification (Monitoring & Visibility, Network Operator)
Implementation Guidance: EPfafgeec t7iv1eness (H/M/L): MThe Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
Implementation Difficulty: (H/M/L): H
BP Number: 9-8-8914
Use Tiered Bot Detection Approach:
Network Operators should use a tiered approach to botnet detection that first applies
bBePh Raveifoerraeln cchea/rCacotmermisteincst so:f u ser traffic (cast a wide net), and then applies more granular
techniques (e.g., signature detection) to traffic flagged as a potential problem.
This technique should help minimize the exposure of customer information in detecting
bots by not collecting detailed information until it is reasonable to believe the customer is
infected.
Looking at user traffic using a wide net approach can include external feedback as well as
other internal approaches.
This approach is useful in order to limit the need for more sophisticated tools such as
deep-packet-inspection and signatures. Once malicious bot traffic is suspected (a wide
net), then a more detailed analysis of the traffic can be done.
More information can be found at U.S. Anti-Bot Code of Conduct (ABCs) for Internet Service
Providers (ISPs):
http://transition.fcc.gov/bureaus/pshs/advisory/csric3/CSRIC-III-WG7-Final-Report.pdf
Phase: Identification (Monitoring & Visibility, Network Operator)
Implementation Guidance: Effectiveness (H/M/L): M
Implementation Difficulty: (H/M/L): H
Note that the Best Practices in this grouping are primarily aimed at ISPs that provide
service to consumer end-users on residential broadband networks, but may be applicable
t o other users and networks as well.
Classification
BP Number: New BP 18
Classify DoS/DDoS Attacks:
Network Operators, Hosting Providers, and DDoS Targets, where feasible, should have
processes and/or capabilities to analyze and classify a DoS/DDoS attack. The classification
oBfP a Rtteafcekrse cnacne h/eClopm dmeteernmtsin: e the best mitigations for the attack and help in identifying
improvements needed to provide future protection.
Example Classification:
Volumetric Attack?
Direct Packet Flood
Reflection/Amplification
Application Layer Attack?
State or Resource Exhaustion Attack?
Control Plane Attack?
Ipv6 Specific Attack?
Page 72The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
Date?
Phase: Classification (Type of Attack, Network Operator, Hosting Provider, Target), Post
Mortem & Recovery (Network Operator, Hosting Provider, Target)
Implementation Guidance: Effectiveness (H/M/L): M
Implementation Difficulty: (H/M/L): H
Traceback
BP Number: 9-8-0507:
Attack Trace Back:
Network Operators should have the processes and/or capabilities to analyze and
determine the source of malicious traffic, and then to trace-back and drop the packets at,
or closer to, the source. The references provide several different possible techniques.
(Malicious traffic is that traffic such as Distributed Denial of Service (DDoS) attacks, smurf
and fraggle attacks, designed and transmitted for the purpose of consuming resources of a
dBePs tRineafetiroenn nceet/wCoormkm toe bnltosc:k service or consume resources to overflow state that might
cause system crashes).
"Practical Network Support for IP Trace back" by Stefan Savage et.al., Dept. of Computer
Science and Engineering, Univ of Washington, Tech Report UW-CSE-2000-02-01 with a
version published in the Proceedings of the 2000 ACM SIBCOMM pp256-306 Stockholm,
Sweden, August 2000.
Phase: Traceback (Network Operators)
Implementation Guidance: Effectiveness (H/M/L): H
Implementation Difficulty: (H/M/L): H
Reaction
BP Number: 9-9-8065
Network Operators and Hosting Providers should establish a process for releasing
iBnPfo Rrmefaetrieonn cteo/ mCoemmbmeersn otsf :t he law enforcement and identify a Point of Contact (POC) for
coordination activities.
None.
Phase: Reaction (Network Operator, Hosting Providers)
Implementation Guidance: Effectiveness (H/M/L): L
Implementation Difficulty: (H/M/L): L
Page 73The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
Post Mortem & Recovery
BP Number: 9-9-8762
Recover from DoS Attack:
Updated to:
Network Operators and Hosting Providers should when feasible, cooperate with other
organizations during and after significant cyber incidents to share information on steps
taken to characterize the attack, on techniques to identify, filter, and isolate the originating
points of the attack, and on actions taken to reroute legitimate traffic and to deter or
defend against similar DoS attacks.
BP Reference/Comments:
IETF RFC2350, CMU/SEI-98-HB-001. Note: This Best practice could impact 9-1-1
operations.
Updated to add:
This best practice is aimed at the recovery of the operator's infrastructure from DoS attack.
Phase: Reaction (Network Operator, Hosting Providers); Post Mortem (Network Operator,
Hosting Providers)
I mplementation Guidance: Effectiveness (H/M/L): M
Implementation Difficulty: (H/M/L): M
BP Number: 9-8-8515
Recovery from Misuse or Undue Consumption of System Resources:
Updated to:
If a misuse or unauthori,zed use of a system under their control is detected (e.g., detection
of participation in a DDoS attack), Network Operators, Hosting Providers, or Targets
sBhPo Ruledf,e wrehnecree /pCroacmtimcaeln ptesr: form forensic analysis on the system, conduct a post-mortem
analysis, apply controls to prevent future attacks, and/or enforce system resource quotas.
IETF RFC2350, CMU/SEI-98-HB-001.
Phase: Post Mortem (Network Operator, Hosting Provider, Target)
I mplementation Guidance: Effectiveness (H/M/L): M
Implementation Difficulty: (H/M/L): H
Page 74The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
Hosting Providers
Preparation
BP Number: New BP10
Regularly Update Technology with Security Updates or New Versions Provided by
Vendors:
Hosting Providers should take reasonable steps to provide up to date software and plug-
ins for their customers (in cases where Hosting Providers offer software). Software
provided to customers should be actively supported by the vendor for security fixes.
Patching tools, processes or instructions should be provided to customers to help them
keep their software current with security patches. Where feasible, select software that
pBrPo Rviedfeesr aeuntcoem/Caotimc smeceunrtisty: updates and provide customers with instructions on how to
activate updates.
TBD
Phase: Preparation (Protect, Hosting Provider)
Implementation Guidance: Effectiveness (H/M/L): H
Implementation Difficulty: (H/M/L): H
BP Number: 9-8-8753 (Repeated from Network Operator Section)
Vulnerability Management:
Updated to:
Network Operators, Hosting Providers, and hardware/software vendors should ensure
they can manage security vulnerabilities in products they manage or maintain for
customers. Such management may be passive, such as simply maintaining a list of
customers to whom they have distributed the product, or active, such as vulnerability
sBcPa nRneifnegr eanndce r/eCpoomrtimnge.n Atsls: o, products, services, hardware and software should be tested
for vulnerabilities prior to significant deployments.
Sans Institute, "Vulnerability Management: Tools, Challenges and Best Practices." 2003. Pg.
12 - 13.
Preparation (Protect) BP
Phase: Preparation (Protect, Network Operator, Hosting Providers)
Implementation Guidance: Effectiveness (H/M/L): H
Implementation Difficulty: (H/M/L): H
BP Number: 9-8-8753A – New BP (Formerly BP 9-8-8563) (Repeated from Network
Operator Section)
Vulnerability Management - Notification:
Updated to:
When a DoS or DDoS vulnerability or exploit is discovered, Network Operators, Hosting
Providers, and hardware/software vendors should notify owners/operators of the affected
systems of the issue to ensure software, con figuration s, or equipment is updated to
Page 75The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
remediate the vulnerability. If short term remediation is not possible, owners/operators
sBhPo Ruledf ecroennsicdee/rC soymstmeme notrs n: etwork mitigations to minimize the likelihood of DDoS attack
exploitation.
Sans Institute, "Vulnerability Management: Tools, Challenges and Best Practices." 2003. Pg.
12 - 13.
Preparation (Protect) BP
Phase: Preparation (Protect, Network Operator, Hosting Providers)
Implementation Guidance: Effectiveness (H/M/L): H
Implementation Difficulty: (H/M/L): H
BP Number: 9-8-8917 (Repeated from Network Operator Section)
Notification to End Users:
Network Operators and Hosting Providers should develop and maintain critical
notification methods to communicate with their customers that their computer, servers,
and/or network has likely been infected with malware. This should include a range of
options in order to accommodate a diverse group of customers and network technologies.
Once a Network Operator has detected a likely end user security problem, steps should be
undertaken to inform the Internet user that they may have a security problem. A Network
Operator or Hosting Provider should decide the most appropriate method or methods for
providing notification to their customers or internet users, and should use additional
methods if the chosen method is not effective. The range of notification options may vary
by the severity and/or criticality of the problem.
Examples of different notification methods may include but are not limited to: email,
tBePle Rpehfoenree cnaclel,/ pCoosmtaml meanitls, :i nstant messaging (IM), short messaging service (SMS), and
web browser notification.
A Network Operator and Hosting Provider decision on the most appropriate method or
methods for providing notification to one or more of their customers or Internet users
depends upon a range of factors, from the technical capabilities of the Network Operator,
to the technical attributes of the Network Operator's network, cost considerations,
available server resources, available organizational resources, the number of likely
infected hosts detected at any given time, and the severity of any possible threats, among
many other factors. The use of multiple simultaneous notification methods is reasonable
for an Network Operator but may be difficult for a fake anti-virus purveyor. Note that the
use of blind Notifications, i.e., Notifications without follow-up, have been found to be less
effective than methods that verify or require user action. Best Practice 9-8-8921 provides
information on how to address the malware infection. https://otalliance.org/best-
practices/industry-best-practices
More information can be found at:
https://otalliance.org/system/files/files/resource/documents/ota_botnet_notification_wh
itepaper2012.pdf
Phase: Preparation (Communication, Network Operator, Hosting Provider)
Implementation Guidance: Effectiveness (H/M/L): L
Implementation Difficulty: (H/M/L): M
Page 76The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
Note that the Best Practices in this grouping are primarily aimed at ISPs that provide
services to consumer end-users on residential broadband networks, but may be applicable
to other users and networks as well.
BP Number: 9-8-8901
Hosting Providers Support for Educational Resources for Computer Hygiene / Safe
UCopmdapteudti tnog: :
Hosting Providers should provide, make available, identify, or support third-party tutorial,
educational, and self-help resources for their customers to educate them on the
importance of and help them practice safe computing. Hosting Provider customers should
know to protect end user devices and networks from unauthorized access through various
metho ds, including, but not limited to:
1) Use legitimate security software that protects against viruses and spywares;
2) Ensure that any software downloads or purchases are from a legitimate source;
3) Use firewalls;
4) Maintain current security patches to the operating system, databases, applications,
and application plug-ins;
5) Educate customers on the importance of vulnerability management and scanning.
6) Remove and discontinue use of software that is not maintained with security
patches;
7) Scan the servers regularly for malicious software, spyware and other potentially
unwanted software;
8) Keep all applications, application plug-ins, and operating system software current
and updated and use their security features;
9) Use strong passwords and/or 2-factor authentication; and
BP R10e)fNereevnecr es/hCaorem pmasesnwtso:r ds.
11)Provide contact information to report issues.
More information can be found at:
National Cyber Security Alliance - http://www.staysafeonline.org/
OnGuard Online - http://www.onguardonline.gov/default.aspx
Department of Homeland Security -
StopBadware – http://www.stopbadware.org/home/badware_prevent
Comcast.net Security - http://security.comcast.net/
Verizon Safety & Security -
http://www.verizon.net/central/vzc.portal?_nfpb=X&_pageLabel=vzc_help_safety
Qwest Incredible Internet Security site: http://www.incredibleinternet.com/
Microsoft- http://www.microsoft.com/security/pypc.aspx
Phase: Preparation (Education, Hosting Providers)
Implementation Guidance: Effectiveness (H/M/L): L
Implementation Difficulty: (H/M/L): L
Note that the Best Practices in this grouping are primarily aimed at ISPs that provide
service to consumer end-users on residential broadband networks, but may be applicable
to other users and networks as well.
Page 77The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
BP Number: 9-9-8068 (Repeated from Network Operator Section)
Service Providers, Network Operators, Hosting Providers, Public Safety, and Equipment
Suppliers should develop and practice a communications plan as part of the broader
Incident response plan identifying key players to include as many of the following items as
appropriate: contact names, business telephone numbers, home telephone numbers, pager
numbers, fax numbers, cell phone numbers, home addresses, internet addresses,
permanent bridge numbers, etc. Notification plans should be developed prior to an
event/incident happening where necessary. The plan should also include alternate
communications channels (e.g., alpha pagers, internet, satellite phones, VOIP, private lines,
sBmPa Rret fpehroennecse)/ bCaolamnmcinegn ttsh:e value of any alternate method against the security and
information loss risks introduced.
Alternate broadband communication path for coordination and management.
Phase: Preparation (Communication, Network Operator, Hosting Provider)
I mplementation Guidance: Effectiveness (H/M/L): H
Implementation Difficulty: (H/M/L): L
BP Number: 8-9-8074 (Repeated from Network Operator Section)
Updated
Denial of Service (DoS) Attack - Target: (Repeated from Network Operator Section)
Where feasible, Network Operators, Hosting Providers, Target networks and Equipment
Supplier equipment should be able to survive significant increases in both packet count
and bandwidth utilization. Where feasible, Equipment and Software Suppliers should
develop effective DoS/DDoS survivability features for their product lines.
Infrastructure supporting mission critical services should be designed for significant
increases in traffic volume and must include network devices capable of filtering and/or
rate limiting traffic. Network engineers must understand the capabilities of the devices and
how to employ them to maximum effect. Wherever practical, mission critical systems
should be deployed in clustered configuration allowing for load balancing of excess traffic
aBnPd R perfoetreecntecde /bCyo am pmurepnotsse: built DoS/DDoS protection device. Operators of critical
infrastructure should deploy DoS survivable hardware and software whenever possible.
Note: This Best Practice could impact 9-1-1 operations.
e.g., SYN Flood attack defense, CERT/CC ® Advisory CA-1996-21 TCP SYN Flooding and IP
Spoofing Attacks - http://www.cert.org/advisories/CA-1996-21.html. Related to NRIC BP
8753A.
Note that, Network Operators, Hosting Providers, Targets, and Equipment Suppliers need
to determine which services are mission critical in the implementation of this Best
Practice.
Phase: Preparation (Capacity and Resources, Network Operator, Hosting Provider, Target)
Implementation Guidance: Effectiveness (H/M/L): M
Implementation Difficulty: (H/M/L): H
Page 78The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
BP Number: New BP8 (Repeated from Network Operator Section)
Deploy Anti-Spoofing Technologies:
NBPet Rweofrekr Oenpceera/tCoorms, manedn Htso:s ting Providers should, where feasible, deploy anti-spoofing
technologies to prevent spoofed traffic from originating from their networks.
Related to BP 9-7-0408
Note that deployment may not be feasible on some multi-homed networks because of the
need for asymmetrical routing.
Phase: Preparation (Protect, Network Operator, Hosting Providers)
Implementation Guidance: Effectiveness (H/M/L):H
Implementation Difficulty: (H/M/L):
Single Home Networks: L
Multi-Homed Networks: H
BP Number:New BP1
Application Based Network Protection:
Hosting Providers and attack sources should consider utilizing application based network
and/or host based Intrusion Detection Systems, firewalls, or other security devices,
cBoPn Rfigeuferreedn tcoe d/eCnoym trmafefnict bs:y default, to protect against malicious or otherwise
unauthorized incoming or outbound network traffic in their hosting centers or on servers.
GB973 Guide - 4 /DSD 2011 #8 (Modified)
GB973 Guide - 5 /DSD 2011 #9 (Modified)
For example: Utilize border control function, e.g., session border controllers or similar
devices, to prevent denial /degradation of VOIP communication by blocking registration
storms from server farms (unauthorized endpoints) and blocking protocol fuzzing
attempts.
Note that it is important to ensure that the application protection deployed is not itself
vulnerable to a DoS/DDoS attack. If its design or configuration makes it vulnerable to
attack the device may make the application more susceptible to a DDoS attack.
Phase: Preparation (Prevention, Hosting Provider)
Implementation Guidance: Effectiveness (H/M/L): M
Implementation Difficulty: (H/M/L): M
Identification
BP Number: New BP11
Monitoring of Hosting Environment for Malicious or DDoS Traffic:
HBPos Rtienfge rPeronvcied/eCros,m wmheernet sfe: asible, should monitor their environments for malicious or
DDoS network traffic to identify sources and methods of attacks.
TBD
Phase: Identification (Hosting Provider)
Implementation Guidance: Eff ectivenes s (H/M/L): H
Page 79The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
Implementation Difficulty: (H/M/L): M
BP Number: 9-8-8916 (Repeated from Network Operator Section)
Bot Detection and the Corresponding Notification Should Be Timely:
Updated to:
Network Operators and Hosting Providers should ensure that bot detection and the
corresponding notification to hosting customers are timely, since such security problems
are time-sensitive. If complex analysis is required and multiple confirmations are needed
to confirm a bot is indeed present, then it is possible that the malware may cause some
damage, to either the infected host or remotely targeted system (beyond the damage of the
initial infection) before it can be stopped. Thus, a Network Operator or Hosting Provider
must balance a desire to definitively confirm a malware infection, which may take an
extended period of time, with the ability to predict the strong likelihood of a malware
infection in a very short period of time. This 'definitive-vs.-likely' challenge is difficult and,
when in doubt, Network Operators and Hosting Providers should error on the side of
cBaPu tRioenfe brye ncocem/mCoumnimcaetinntgs a: likely malware infection while taking reasonable steps to
avoid false positive notifications.
The Network Operator notification implementation needs to balance the certainty of a
detected infection with the uncertainty of a transient detection of malicious traffic to
minimize the possibility of false-positive notifications which could become an annoyance
to customers and become unmanageable by the Network Operator.
More information can be found at U.S. Anti-Bot Code of Conduct (ABCs) for Internet Service
Providers (ISPs):
http://transition.fcc.gov/bureaus/pshs/advisory/csric3/CSRIC-III-WG7-Final-Report.pdf
Phase: Identification (Monitoring & Visibility, Network Operator, Hosting Provider)
Implementation Guidance: Effectiveness (H/M/L): L (notification only)
Implementation Difficulty: (H/M/L): M
Note that the Best Practices in this grouping are primarily aimed at ISPs that provide
service to consumer end-users on residential broadband networks, but may be applicable
to other users and networks as well.
BP Number: New BP6 (Repeated from Network Operator Section)
Use Netflow Data analysis to Analyze DDoS Attacks:
Where feasible, Network Operators and Hosting Providers, should enable, collect, and
analyze Netflow data to aid in the identification and classification of DDoS attacks. Data
sBhPo Ruledf ebree anvcaeil/aCbolem amfteern tths:e attack to allow further analysis. Netflow data should be
retained consistent with the Network Operator’s data retention policy.
Netflow data may be useful in identifying spoofing attacks.
Phase: Identification (Monitoring and Visibility, Network Operator, Hosting Providers)
I mplementation Guidance: Effectiveness (H/M/L): H
Implementation Difficulty: (H/M/L): M
Page 80The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
Classification
BP Number: New BP18 (Repeated from Network Operator Section)
Classify DoS/DDoS Attacks:
Network Operators, Hosting Providers, and DDoS Targets, where feasible, should have
processes and/or capabilities to analyze and classify a DoS/DDoS attack. The classification
oBfP a Rtteafcekrse cnacne h/eClopm dmeteernmtsin: e the best mitigations for the attack and help in identifying
improvements needed to provide future protection.
Example Classification:
Volumetric Attack?
Direct Packet Flood
Reflection/Amplification
Application Layer Attack?
State or Resource Exhaustion Attack?
Control Plane Attack?
Ipv6 Specific Attack?
Date?
Phase: Classification (Type of Attack, Network Operator, Hosting Provider, Target), Post
Mortem & Recovery (Network Operator, Hosting Provider, Target)
Implementation Guidance: Effectiveness (H/M/L): M
Implementation D ifficulty: (H/M/L): H
Traceback
Reaction
BP Number: New BP12
Notify Hosting Customers of Malicious or DDoS Traffic
Hosting Providers, where feasible, should notify affected customers if malicious or DDoS
nBePt wReofrekr ternafcfeic/ iCso dmetmecetnetds e: manating from their servers and, if appropriate, assist
customers with remediation.
TBD
Phase: Reaction (Hosting Provider)
Implementation Guidance: Effectiveness (H/M/L): M
Implementation Difficulty: (H/M/L): H
BP Number: 9-9-8065 (Repeated from Network Operator Section)
Network Operators and Hosting Providers should establish a process for releasing
information to members of the law enforcement and identify a Point of Contact (POC) for
coordination activities.
Page 81The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
BP Reference/Comments:
None.
Phase: Reaction (Network Operator, Hosting Providers)
Implementation Guidance: Effectiveness (H/M/L): L
Implementation Difficulty: (H/M/L): L
Post Mortem & Recovery
BP Number: 9-9-8762 (Repeated from Network Operator Section)
Recover from DoS Attack:
Updated to:
Network Operators and Hosting Providers should when feasible, cooperate with other
organizations during and after significant cyber incidents to share information on steps
taken to characterize the attack, on techniques to identify, filter, and isolate the originating
points of the attack, and on actions taken to reroute legitimate traffic and to deter or
defend against similar DoS attacks.
BP Reference/Comments:
IETF RFC2350, CMU/SEI-98-HB-001. Note: This Best practice could impact 9-1-1
operations.
Updated to add:
This best practice is aimed at the recovery of the operator's infrastructure from DoS attack.
Phase: Reaction (Network Operator, Hosting Providers); Post Mortem (Network Operator,
Hosting Providers)
I mplementation Guidance: Effectiveness (H/M/L): M
Implementation Difficulty: (H/M/L): M
BP Number: 9-8-8515 (Repeated from Network Operator Section)
Recovery from Misuse or Undue Consumption of System Resources:
Updated to:
If a misuse or unauthori,zed use of a system under their control is detected (e.g., detection
of participation in a DDoS attack), Network Operators, Hosting Providers, or Targets
sBhPo Ruledf,e wrehnecree /pCroacmtimcaeln ptesr: form forensic analysis on the system, conduct a post-mortem
analysis, apply controls to prevent future attacks, and/or enforce system resource quotas.
IETF RFC2350, CMU/SEI-98-HB-001.
Phase: Post Mortem (Network Operator, Hosting Provider, Target)
Implementation Guidance: Effectiveness (H/M/L): M
Implementation Difficulty: (H/M/L): H
Page 82The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
Targets
Preparation
BP Number: 8-9-8074 (Repeated from Network Operator Section)
Updated
Denial of Service (DoS) Attack - Target:
Where feasible, Network Operators, Hosting Providers, and Target networks and
Equipment Supplier equipment should be able to survive significant increases in both
packet count and bandwidth utilization. Where feasible, Equipment and Software
Suppliers should develop effective DoS/DDoS survivability features for their product lines.
Infrastructure supporting mission critical services should be designed for significant
increases in traffic volume and must include network devices capable of filtering and/or
rate limiting traffic. Network engineers must understand the capabilities of the devices and
how to employ them to maximum effect. Wherever practical, mission critical systems
should be deployed in clustered configuration allowing for load balancing of excess traffic
aBnPd R perfoetreecntecde /bCyo am pmurepnotsse: built DoS/DDoS protection device. Operators of critical
infrastructure should deploy DoS survivable hardware and software whenever possible.
Note: This Best Practice could impact 9-1-1 operations.
e.g., SYN Flood attack defense, CERT/CC ® Advisory CA-1996-21 TCP SYN Flooding and IP
Spoofing Attacks - http://www.cert.org/advisories/CA-1996-21.html. Related to NRIC BP
8753A.
Note that, Network Operators, Hosting Providers, Targets, and Equipment Suppliers need
to determine which services are mission critical in the implementation of this Best
Practice.
Phase: Preparation (Capacity and Resources, Network Operator, Hosting Provider, Target)
Implementation Guidance: Effectiveness (H/M/L): M
Implementation Difficulty: (H/M/L): H
BP Number: New BP7
Web services should limit payloads which may result in bandwidth congestion
outbound from the web servers:
Providers of Web Applications should limit large objects, such as large document
downloads, to prevent repeated requests from consuming significant outbound bandwidth
from the server (i.e., bandwidth from server sit e to client site), which can cause a DoS
cBoPn Rdietfioenre fnorc ele/gCiotimmmatee nutsse:r s. Also, consider limiting the number of http get/post requests
allowed per IP address in a specific time range.
TBD
Phase: Preparation (Minimize Attack Surface, Target)
I mplementation Guidance: Effectiveness (H/M/L): M
Implementation Difficulty: (H/M/L): H
Page 83The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
BP Number: New BP13
Monitoring of Target for Malicious or DDoS Traffic:
Targets should monitor security and server logs to determine if anomalous traffic or
sBePc uRreitfye reevnecnets/ Choavmem ocecnutrsr:e d. This is useful in determining if the Target is under attack
or an attack has recently taken place; it may also indicate a precursor of an attack.
Note that targets of attacks can be End Users as well as Network Operators and Hosting
Providers.
Phase: Preparation (Monitoring & Visibility, Target)
I mplementation Guidance: Effectiveness (H/M/L): H
Implementation Difficulty: (H/M/L): M
BP Number: New BP15
Utilize Content Delivery Networks to Provide Application Robustness:
Attack Targets should utilize Content Delivery Networks (CDNs) to provide robustness to
mBPin Rimefiezere snucsece/pCtoibmilmitye ntot sD: oS/DDoS attacks. CDNs may be used to distribute application
capability throughout the network making it more robust against DoS/DDoS attacks.
TBD
Phase: Preparation (Deploy Mitigation Tools, Target)
Implementation Guidance: Effectiveness (H/M/L): H
Implementation Difficulty: (H/M/L): L
BP Number: New BP17
Deploy On-Site Target Data Scrubbing:
DDoS Targets may employ, where feasible, traffic data scrubbing centers to filter DDoS
attack traffic. This can be accomplished by “offramping” suspected attack DDoS traffic to
aBnP oRne-fseitree snccreu/bCboinmgm ceennttesr: where attack traffic can be filtered and “onramping” legitimate
traffic back to the target.
It is important to size the capacity of the on-site network and scrubbing centers to
accommodate attack traffic so as to minimize potential collateral damage caused by large
surges in traffic.
Phase: Preparation (Deploy Mitigation Tools, Hosting Filtering)
Implementation Guidance: Effectiveness (H/M/L): H
Implementation Difficulty: (H/M/L): H
Identification
Page 84The Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
Classification
BP Number: New BP18 (Repeated from Network Operator Section)
Classify DoS/DDoS Attacks:
Network Operators, Hosting Providers, and DDoS Targets, where feasible, should have
processes and/or capabilities to analyze and classify a DoS/DDoS attack. The classification
oBfP a Rtteafcekrse cnacne h/eClopm dmeteernmtsin: e the best mitigations for the attack and help in identifying
improvements needed to provide future protection.
Example Classification:
Volumetric Attack?
Direct Packet Flood
Reflection/Amplification
Application Layer Attack?
State or Resource Exhaustion Attack?
Control Plane Attack?
Ipv6 Specific Attack?
Date?
Phase: Classification (Type of Attack, Network Operator, Hosting Provider, Target), Post
Mortem&Recovery (Network Operator, Hosting Provider, Target)
Implementation Guidance: Effectiveness (H/M/L): M
Implementation D ifficulty: (H/M/L): H
Traceback
Reaction
Post Mortem & Recovery
BP Number: 9-8-8561
Recovery from Denial of Service Attack - Target:
If a net work element, system or server under the Target’s control experienced a DoS or
DDoS a ttack, the Target should consider:
1) Adding more local capacity (bandwidth or servers) to the attacked service;
2) Deploying DoS/DDoS specific premise based mitigation devices and/or use anti-
DoS capabilities in local hardware;
3) Purchasing network based DDoS protections for their Network Operator, Hosting
Provider, or a third party DDoS mitigation provider;
4) For appropriate systems such as websites, prepare a plan to minimized services
provided by the site if a future attack occurs that diminishes the effects of the
attack while still providing essential or important services to their clients;
5) Coordinate with software and hardware vendors for guidance on optimal device
configuration;
6) Architect their system to capture attack traffic, attacking IP addresses and
corresponding timestamps;
7) Share capture hostile/attack code, Ptaacgteic 8s5, techniques, attack sources, andThe Communications Security, Reliability and Interoperability Council IV Working Group 5
Final Report September, 2014
procedures to organizations who may experience similar types of attacks and to
central coordination organizations such as US-CERT and NCS/NCC for review,
analysis and distribution to a wider audience; and
8) Work with the Network Operator, Hosting Provider, ISAC or CERT to identify
BP Refeartetancckein/gC ocmommpeuntetsrs: and clean up the machines on the distant end to minimize the
possibility of future attacks.
Phase: Post Mortem (Target)
Implementation Guidance: Effectiveness (H/M/L): M
Implementation Difficulty: (H/M/L): H
BP Number: 9-8-8515 (Repeated from Network Operator Section)
Recovery from Misuse or Undue Consumption of System Resources:
Updated to:
If a misuse or unauthori,zed use of a system under their control is detected (e.g., detection
of participation in a DDoS attack), Network Operators, Hosting Providers, or Targets
sBhPo Ruledf,e wrehnecree /pCroacmtimcaeln ptesr: form forensic analysis on the system, conduct a post-mortem
analysis, apply controls to prevent future attacks, and/or enforce system resource quotas.
IETF RFC2350, CMU/SEI-98-HB-001.
Phase: Post Mortem (Network Operator, Hosting Provider, Target)
Implementation Guidance: Effectiveness (H/M/L): M
Implementation Difficulty: (H/M/L): H
Page 86
